<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>TeXtidote analysis</title>
<style type="text/css">
body {
  font-family: sans-serif;
}
.highlight, .highlight-sh, .highlight-spelling {
  padding: 2pt;
  border-radius: 4pt;
  cursor: help;
  opacity: 0.7;
  border: dashed 1px;
}
.highlight {
  background-color: orange;
  color: black;
}
.highlight-sh {
  background-color: yellow;
  color: black;
}
.highlight-spelling {
  background-color: red;
  color: white;
}
div.original-file {
  font-family: monospace;
  font-size: 11pt;
  background-color: #f8f8ff;
  padding: 20pt;
  border-radius: 6pt;
}
.textidote {
  	background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiAgIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyIgICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgICB4bWxuczpzb2RpcG9kaT0iaHR0cDovL3NvZGlwb2RpLnNvdXJjZWZvcmdlLm5ldC9EVEQvc29kaXBvZGktMC5kdGQiICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiICAgd2lkdGg9IjEwMC4wOTEwNW1tIiAgIGhlaWdodD0iMTguMjA5MDk5bW0iICAgdmlld0JveD0iMCAwIDEwMC4wOTEwNSAxOC4yMDkwOTkiICAgdmVyc2lvbj0iMS4xIiAgIGlkPSJzdmc4IiAgIGlua3NjYXBlOnZlcnNpb249IjAuOTEgcjEzNzI1IiAgIHNvZGlwb2RpOmRvY25hbWU9InRleHRpZG90ZS5zdmciPiAgPGRlZnMgICAgIGlkPSJkZWZzMiIgLz4gIDxzb2RpcG9kaTpuYW1lZHZpZXcgICAgIGlkPSJiYXNlIiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiICAgICBib3JkZXJvcGFjaXR5PSIxLjAiICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIgICAgIGlua3NjYXBlOnpvb209IjEiICAgICBpbmtzY2FwZTpjeD0iLTI1NC4yNTMwOSIgICAgIGlua3NjYXBlOmN5PSItMjc4LjM3NTkxIiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9Im1tIiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIiAgICAgc2hvd2dyaWQ9ImZhbHNlIiAgICAgZml0LW1hcmdpbi10b3A9IjAiICAgICBmaXQtbWFyZ2luLWxlZnQ9IjAiICAgICBmaXQtbWFyZ2luLXJpZ2h0PSIwIiAgICAgZml0LW1hcmdpbi1ib3R0b209IjAiICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjE5MjAiICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSIxMDIxIiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjAiICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMjY1IiAgICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMSIgLz4gIDxtZXRhZGF0YSAgICAgaWQ9Im1ldGFkYXRhNSI+ICAgIDxyZGY6UkRGPiAgICAgIDxjYzpXb3JrICAgICAgICAgcmRmOmFib3V0PSIiPiAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+ICAgICAgICA8ZGM6dHlwZSAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4gICAgICAgIDxkYzp0aXRsZSAvPiAgICAgIDwvY2M6V29yaz4gICAgPC9yZGY6UkRGPiAgPC9tZXRhZGF0YT4gIDxnICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIgICAgIGlua3NjYXBlOmdyb3VwbW9kZT0ibGF5ZXIiICAgICBpZD0ibGF5ZXIxIiAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI5LjczODA5NSwtNzAuNTc3NzUxKSI+ICAgIDxnICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zaXplOjIwLjkyODk0NTU0cHg7bGluZS1oZWlnaHQ6MS4yNTtmb250LWZhbWlseTpzYW5zLXNlcmlmO2xldHRlci1zcGFjaW5nOjBweDt3b3JkLXNwYWNpbmc6MHB4O2ZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45Nzc1MzgyMztzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIgICAgICAgaWQ9InRleHQ4MzYiPiAgICAgIDxwYXRoICAgICAgICAgZD0ibSAzMC43MjY4NjQsNzEuNTY2NTIgNS4yMzIyMzYsMCAwLDQuMjA5MDQ0IDUuODEzNTk2LDAgMCwzLjYwNDQyOSAtNS44MTM1OTYsMCAwLDQuODEzNjU4IDUuODEzNTk2LDAgMCwzLjYwNDQyOSAtMTEuMDQ1ODMyLDAgMCwtMTYuMjMxNTYgeiIgICAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LWZhbWlseTpUdXRvcjstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOlR1dG9yO2ZpbGw6I2ZmZmZmZjtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45Nzc1MzgyMztzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIgICAgICAgICBpZD0icGF0aDMzODYiIC8+ICAgICAgPHBhdGggICAgICAgICBkPSJtIDQyLjMzNTg4OCw3NS43NzU1NjQgMTEuMDQ1ODMyLDAgMCw3LjgxMzQ3MyAtNS44MTM1OTYsMCAwLDAuNjA0NjE0IDUuODEzNTk2LDAgMCwzLjYwNDQyOSAtMTEuMDQ1ODMyLDAgMCwtMTIuMDIyNTE2IHogbSA1LjIzMjIzNiw0LjIwOTA0MyAwLjU4MTM2LDAgMCwtMC42MDQ2MTQgLTAuNTgxMzYsMCAwLDAuNjA0NjE0IHoiICAgICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7Zm9udC1mYW1pbHk6VHV0b3I7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpUdXRvcjtmaWxsOiNmZmZmZmY7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTc3NTM4MjM7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmUiICAgICAgICAgaWQ9InBhdGgzMzg4IiAvPiAgICAgIDxwYXRoICAgICAgICAgZD0ibSA1My45NDQ5MTIsNzUuNzc1NTY0IDUuMjMyMjM2LDAgMCwzLjYwNDQyOSAtNS4yMzIyMzYsMCAwLC0zLjYwNDQyOSB6IG0gNS44MTM1OTYsMCA1LjIzMjIzNiwwIDAsMy42MDQ0MjkgLTUuMjMyMjM2LDAgMCwtMy42MDQ0MjkgeiBtIC01LjgxMzU5Niw4LjQxODA4NyA1LjIzMjIzNiwwIDAsMy42MDQ0MjkgLTUuMjMyMjM2LDAgMCwtMy42MDQ0MjkgeiBtIDUuODEzNTk2LDAgNS4yMzIyMzYsMCAwLDMuNjA0NDI5IC01LjIzMjIzNiwwIDAsLTMuNjA0NDI5IHoiICAgICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7Zm9udC1mYW1pbHk6VHV0b3I7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpUdXRvcjtmaWxsOiNmZmZmZmY7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTc3NTM4MjM7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmUiICAgICAgICAgaWQ9InBhdGgzMzkwIiAvPiAgICAgIDxwYXRoICAgICAgICAgZD0ibSA2NS41NTM5MzYsNzEuNTY2NTIgNS4yMzIyMzYsMCAwLDQuMjA5MDQ0IDUuODEzNTk2LDAgMCwzLjYwNDQyOSAtNS44MTM1OTYsMCAwLDQuODEzNjU4IDUuODEzNTk2LDAgMCwzLjYwNDQyOSAtMTEuMDQ1ODMyLDAgMCwtMTYuMjMxNTYgeiIgICAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LWZhbWlseTpUdXRvcjstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOlR1dG9yO2ZpbGw6I2ZmZmZmZjtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45Nzc1MzgyMztzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIgICAgICAgICBpZD0icGF0aDMzOTIiIC8+ICAgICAgPHBhdGggICAgICAgICBkPSJtIDc3LjE2Mjk2LDc1Ljc3NTU2NCA1LjIzMjIzNiwwIDAsMTIuMDIyNTE2IC01LjIzMjIzNiwwIDAsLTEyLjAyMjUxNiB6IG0gMCwtNC4yMDkwNDQgNS4yMzIyMzYsMCAwLDMuNjA0NDMgLTUuMjMyMjM2LDAgMCwtMy42MDQ0MyB6IiAgICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtZmFtaWx5OlR1dG9yOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246VHV0b3I7ZmlsbDojZmZmZmZmO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk3NzUzODIzO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIiAgICAgICAgIGlkPSJwYXRoMzM5NCIgLz4gICAgICA8cGF0aCAgICAgICAgIGQ9Im0gODIuOTY3NDcyLDc1Ljc3NTU2NCA1LjgxMzU5NiwwIDAsLTQuMjA5MDQ0IDUuMjMyMjM2LDAgMCwxNi4yMzE1NiAtMTEuMDQ1ODMyLDAgMCwtMTIuMDIyNTE2IHogbSA1LjIzMjIzNiw4LjQxODA4NyAwLjU4MTM2LDAgMCwtNC44MTM2NTggLTAuNTgxMzYsMCAwLDQuODEzNjU4IHoiICAgICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7Zm9udC1mYW1pbHk6VHV0b3I7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpUdXRvcjtmaWxsOiNmZmZmZmY7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTc3NTM4MjM7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmUiICAgICAgICAgaWQ9InBhdGgzMzk2IiAvPiAgICAgIDxwYXRoICAgICAgICAgZD0ibSA5NC41NzY0OTYsNzUuNzc1NTY0IDExLjA0NTgzNCwwIDAsMTIuMDIyNTE2IC0xMS4wNDU4MzQsMCAwLC0xMi4wMjI1MTYgeiBtIDUuMjMyMjM3LDguNDE4MDg3IDAuNTgxMzU3LDAgMCwtNC44MTM2NTggLTAuNTgxMzU3LDAgMCw0LjgxMzY1OCB6IiAgICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtZmFtaWx5OlR1dG9yOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246VHV0b3I7ZmlsbDojZmZmZmZmO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk3NzUzODIzO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIiAgICAgICAgIGlkPSJwYXRoMzM5OCIgLz4gICAgICA8cGF0aCAgICAgICAgIGQ9Im0gMTA2LjE4NTUyLDcxLjU2NjUyIDUuMjMyMjQsMCAwLDQuMjA5MDQ0IDUuODEzNTksMCAwLDMuNjA0NDI5IC01LjgxMzU5LDAgMCw0LjgxMzY1OCA1LjgxMzU5LDAgMCwzLjYwNDQyOSAtMTEuMDQ1ODMsMCAwLC0xNi4yMzE1NiB6IiAgICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtZmFtaWx5OlR1dG9yOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246VHV0b3I7ZmlsbDojZmZmZmZmO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk3NzUzODIzO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIiAgICAgICAgIGlkPSJwYXRoMzQwMCIgLz4gICAgICA8cGF0aCAgICAgICAgIGQ9Im0gMTE3Ljc5NDU0LDc1Ljc3NTU2NCAxMS4wNDU4NCwwIDAsNy44MTM0NzMgLTUuODEzNiwwIDAsMC42MDQ2MTQgNS44MTM2LDAgMCwzLjYwNDQyOSAtMTEuMDQ1ODQsMCAwLC0xMi4wMjI1MTYgeiBtIDUuMjMyMjQsNC4yMDkwNDMgMC41ODEzNiwwIDAsLTAuNjA0NjE0IC0wLjU4MTM2LDAgMCwwLjYwNDYxNCB6IiAgICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtZmFtaWx5OlR1dG9yOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246VHV0b3I7ZmlsbDojZmZmZmZmO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk3NzUzODIzO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIiAgICAgICAgIGlkPSJwYXRoMzQwMiIgLz4gICAgPC9nPiAgPC9nPjwvc3ZnPg==);
}
h2.filename {
  font-family: monospace;
}
h1.textidote {
  width: 378px;
  height: 68px;
  display: block;
}
.keyword1 {
  font-weight: bold;
  color: green;
}
.keyword2 {
  font-weight: bold;
  color: darkblue;
}
.comment, .comment * {
  color: darkred;
  font-weight: normal;
}
.linenb {
  font-style: italic;
  color: lightgrey;
  width: 30pt;
  float: left;
  margin-top: 1pt;
  margin-bottom: 1pt;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.codeline {
  margin-left: -30pt;
  padding-left: 60pt;
  margin-top: 1pt;
  margin-bottom: 1pt;
}
.no-text {
  display: none;
}
.clear {
  clear: both;
}
</style>
</head>
<body>
<a href="https://sylvainhalle.github.io/textidote"><h1 class="textidote"><span class="no-text">Results of TeXtidote analysis</span></h1></a>
<p>Here is the result of analyzing your file(s) with TeXtidote. Hover the mouse over highlighted portions of the document to read a tooltip that gives you some writing advice.</p>
<p>Found 10 warning(s)</p>
<div class="original-file">
<div class="linenb">&nbsp;&nbsp;1</div><div class="codeline"><span class="keyword1">\section</span>{Introduction}</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;2</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;3</div><div class="codeline">Neural networks (NNs) and other machine learning (ML) techniques are becoming an increasingly important tool in of modern research process. This is due to their wide application in data-intensive problems, and ability to make progress where prior computational methods have proved otherwise intractable.</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;4</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;5</div><div class="codeline">The primary method of training ML models involves the construction of a loss function or equivalently reward function. This frames the training process as a high-dimensionality optimisation problem. In this setting, the various parameters of the model are varied such as to minimise the aggregate loss of the model's action over a large collection of inputs when compared to known corresponding outputs. It is thus the loss function that grounds the model in a given problem. Their construction varies but they exhibit some general characteristics as will be discussed.</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;6</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;7</div><div class="codeline"><span class="comment"><span class="comment">% Cite: https://en.wikipedia.org/wiki/Symplectic_integrator and DT's unpublished paper.</span></span></div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;8</div><div class="codeline">\todo{check with DT about the wording of "canonical symplectic 2-form of the system"}</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;9</div><div class="codeline">\SymI{}s are numerical integrators for Hamiltonian systems which preserve the canonical symplectic 2-form of the system. </div><div class="clear"></div>
<div class="linenb">&nbsp;10</div><div class="codeline">This makes them widely applicable to physical fields such as orbital dynamics and  molecular dynamics, among others,<span class="comment">%</span></div><div class="clear"></div>
<div class="linenb">&nbsp;11</div><div class="codeline">\todo{Cite papers, some from DT2, some of my own}</div><div class="clear"></div>
<div class="linenb">&nbsp;12</div><div class="codeline"> as they will by this nature, preserve, or near preserve, the constants of motion of a system over a large number of integration steps.</div><div class="clear"></div>
<div class="linenb">&nbsp;13</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;14</div><div class="codeline">The \SI{} (SI)\cite{tsangSLIMPLECTICINTEGRATORSVARIATIONAL2015} is a non-conservative extension of a symplectic integrator which enables numerical integration of non-conservative systems. As with the sympleic integrators, this exhibits well-defined bounds in the fractional error of the energy and other conserved quantities of the system. These are based on the non-conservative action approach developed by Galle<span class="highlight-sh" title="Add a space before citation or reference. [sh:c:001]">y\cite</span>{galleyClassicalMechanicsNonconservative2013} and Galley et al.\cite{galleyPrincipleStationaryNonconservative2014}.</div><div class="clear"></div>
<div class="linenb">&nbsp;15</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;16</div><div class="codeline">Automatic-differentiation techniques are a collection of computational methods for the determination of the derivatives of large classes of \enquote{regular} scientific code in an efficient and accurate manner. In contrast, the \SI{} is currently implemented using computer algebra systems such as SymP<span class="highlight-sh" title="Add a space before citation or reference. [sh:c:001]">y\cite</span>{sympy} which express and work with mathematical expressions symbolically, allowing for the computation of derivatives and integrals. These are general systems and are effective at working with a large range of expressions, but pose limitations when seeking to increase computational speed or scale up to larger, more complex, physical systems.</div><div class="clear"></div>
<div class="linenb">&nbsp;17</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;18</div><div class="codeline">In this paper, we focus on taking the existing mathematical framework of the \SI{} and adapting it to use more advanced computational methods and making it amenable to \autodiff{} to enable a wide class of new applications. These range from scalability to larger systems, for example in molecular dynamics\todo{If I am going to use I need to cite}, to its use as the foundation several physics-based loss functions which we will compare for empirical and theoretical suitability, with the goal that these could be used in the creation of machine learning models which encode physical knowledge and insight.</div><div class="clear"></div>
<div class="linenb">&nbsp;19</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;20</div><div class="codeline"><span class="keyword1">\section</span>{Preliminaries}</div><div class="clear"></div>
<div class="linenb">&nbsp;21</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;22</div><div class="codeline">\<span class="highlight-sh" title="Avoid stacked headings, i.e. consecutive headings without text in between. [sh:stacked]">subsection</span>{Lagrangian Mechanics}</div><div class="clear"></div>
<div class="linenb">&nbsp;23</div><div class="codeline"><span class="keyword1">\label</span>{sec:lag-mech}</div><div class="clear"></div>
<div class="linenb">&nbsp;24</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;25</div><div class="codeline">Lagrangian mechanics is a formalism of classical mechanics which places emphasis on the energies and systems of the system and that allows flexibility in the exact variables used to parameterise the system.</div><div class="clear"></div>
<div class="linenb">&nbsp;26</div><div class="codeline">As it is traditionally phrased it works to solve the problem of determining the evolution of a physical system, parameterised by $n$ generalised degrees of freedom, represented as the vector $\vb q = \set{q_1, \dots, q_n} \in \R^n$, across the timespan $[t_i, t_f] \subset \R$ from some initially known configuration $\vb q_0 \in \R^n$. This determination is done by constructing a functional,</div><div class="clear"></div>
<div class="linenb">&nbsp;27</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;28</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;29</div><div class="codeline">  <span class="keyword1">\label</span>{eq:trad-action}</div><div class="clear"></div>
<div class="linenb">&nbsp;30</div><div class="codeline">  S[\vb{q}] = \int_{t_i}^{t_f} L(\vb{q}, \dot{\vb{q}}, t) \rdd t</div><div class="clear"></div>
<div class="linenb">&nbsp;31</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;32</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;33</div><div class="codeline">where $S$ is known as the action of the system, $\dot\vbq$ is the standard time derivative of the system's path, and $L$ the Lagrangian. The Lagrangian being traditionally made up of two components $T$, the kinetic energy of the system in some configuration at some time, and $V$, the potential energy of the system. These are combined as,</div><div class="clear"></div>
<div class="linenb">&nbsp;34</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;35</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;36</div><div class="codeline">  <span class="keyword1">\label</span>{eq:trad-lag}</div><div class="clear"></div>
<div class="linenb">&nbsp;37</div><div class="codeline">  L(\vb{q}, \dot{\vb{q}}, t) = T(\vb{q}, \dot{\vb{q}}, t) - V(\vb{q}, \dot{\vb{q}}, t).</div><div class="clear"></div>
<div class="linenb">&nbsp;38</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;39</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;40</div><div class="codeline">A physical solution is arrived at by then employing Hamilton's principle of least action \cite{goldsteinClassicalMechanics2000} which provides that the physical path, $\vb q(t)$, is the one that <span class="keyword1">\textit</span>{extremises} the functional $S[\vb q]$ as defined in Equation \eqref{eq:trad-action}, ie one where the variation $\delta S$ with respect to any variation of the path $\delta \vbq(t)$ is zero. This equation can be found by solving the Euler-Lagrange equations,</div><div class="clear"></div>
<div class="linenb">&nbsp;41</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;42</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;43</div><div class="codeline">	<span class="keyword1">\label</span>{eq:euler-lagrange}</div><div class="clear"></div>
<div class="linenb">&nbsp;44</div><div class="codeline">	\frac{\p L}{\p q_i} - \frac{\dd}{\dd t}\frac{\p L}{\p \dot q_i} = 0</div><div class="clear"></div>
<div class="linenb">&nbsp;45</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;46</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;47</div><div class="codeline">for each generalised degree of $q_i$. To each we can also associate a conjugate momentum $p_i$ and generalised force $F_i$,</div><div class="clear"></div>
<div class="linenb">&nbsp;48</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;49</div><div class="codeline"><span class="keyword2">\begin{align}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;50</div><div class="codeline">  p_i = \frac{\p L }{\p \dot q_i} \\</div><div class="clear"></div>
<div class="linenb">&nbsp;51</div><div class="codeline">  F_i = \frac{\p L}{\p q_i}</div><div class="clear"></div>
<div class="linenb">&nbsp;52</div><div class="codeline"><span class="keyword2">\end{align}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;53</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;54</div><div class="codeline">such that Equation \eqref{eq:euler-lagrange} reads in line with Newton's second law, $F = \dot{p}_i$.</div><div class="clear"></div>
<div class="linenb">&nbsp;55</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;56</div><div class="codeline">The focus on symmetries within the formalism comes to the fore however when we consider Noether's Theorem \cite{noetherInvariantVariationProblems1971} which states that every continuous symmetry of the action $S$ has a corresponding conserved quantity. A simple example of this can be seen for degrees of freedom which are said to be <span class="keyword1">\emph</span>{cyclic} in that the coordinate value itself, $q_i$, does not appear directly in the Lagrangian. It can be readily seen from Equation \eqref{eq:euler-lagrange} that if this is the case then,</div><div class="clear"></div>
<div class="linenb">&nbsp;57</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;58</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;59</div><div class="codeline">  \frac{\dd}{\dd t}\frac{\p L}{\p \dot q_i} = 0</div><div class="clear"></div>
<div class="linenb">&nbsp;60</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;61</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;62</div><div class="codeline">which implies that the conjugate momentum $p_i$ is a conserved quantity of the system.</div><div class="clear"></div>
<div class="linenb">&nbsp;63</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;64</div><div class="codeline"><span class="keyword1">\subsection</span>{Non-Conservative Actions}</div><div class="clear"></div>
<div class="linenb">&nbsp;65</div><div class="codeline"><span class="keyword1">\label</span>{sec:intro-nc-actions}</div><div class="clear"></div>
<div class="linenb">&nbsp;66</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;67</div><div class="codeline">Lagrangian mechanics as discussed applies only to conservative systems. While there exist other extensions to non-conservative systems, notably Rayleigh dissipation functions \cite{struttGeneralTheoremsRelating1871} for simple dissipative functions, we will focus on the method put forward by Galley <span class="highlight-sh" title="Use a backslash, comma, or tilde after the period; otherwise LaTeX will think it is a full stop ending a sentence. [sh:010]">et al. </span>\cite{galleyClassicalMechanicsNonconservative2013}.</div><div class="clear"></div>
<div class="linenb">&nbsp;68</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;69</div><div class="codeline">Within this method we incorporate non-conservative behaviour by formally double the degrees of freedom of the system discussed prior into two virtual paths $\vb q_{1,2}$ and considering a new non-conservative Lagrangian $\Lambda$ given by,</div><div class="clear"></div>
<div class="linenb">&nbsp;70</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;71</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;72</div><div class="codeline">  \Lambda = L(\vbq_1, \dot\vbq_1, t) - L(\vbq_1, \dot\vbq_1, t) + K(\vbq_1, \vbq_2, \dot\vbq_1, \dot\vbq_2, t).</div><div class="clear"></div>
<div class="linenb">&nbsp;73</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;74</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;75</div><div class="codeline">This form can be consider as the contribution of the traditional conservative Lagrangian moving forwards along the path traced by $\vbq_1$, and then backwards (and hence negative) along that traced by $\vbq_2$. This additional term $K$ is labelled the non-conservative potential, representing a coupling between the two paths (if it could be broken down cleanly into a form of $V(\vbq_1) - V(\vbq_2)$ or similar then these could be absorbed into $L$ leaving $K = 0$). In practical considerations it is often useful (as will become clear shortly) to alter our choice of variables to instead be $\vbq_+ = {(\vbq_1 + \vbq_2)}/{2}$ and $\vbq_- = \vbq_1 - \vbq_2$. Within this formalism we can also define a corresponding conjugate momenta,</div><div class="clear"></div>
<div class="linenb">&nbsp;76</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;77</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;78</div><div class="codeline">  \pi_{\mp, i} = \frac{\p \Lambda}{\p q_{\pm,i}}.</div><div class="clear"></div>
<div class="linenb">&nbsp;79</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;80</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;81</div><div class="codeline">To solve this system we follow in the same form as before, aiming to extemise a new action defined now in terms of $\Lambda$, however crucially we do so in what is known as the \enquote{physical limit} (P.L), where $\vbq_1 = \vbq_2$ or equivalently $\vbq_- \to \vb 0$. This gives the non-conservative Euler Lagrange equation,</div><div class="clear"></div>
<div class="linenb">&nbsp;82</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;83</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;84</div><div class="codeline">	<span class="keyword1">\label</span>{eq:nc-el}</div><div class="clear"></div>
<div class="linenb">&nbsp;85</div><div class="codeline">  	\left[\frac{\p \Lambda}{\p q_i} - \frac{\dd}{\dd t}\frac{\p \Lambda}{\p \dot q_i}\right]_{\text{P.L}} = 0</div><div class="clear"></div>
<div class="linenb">&nbsp;86</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;87</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;88</div><div class="codeline">note that only the Euler-Lagrange equation differentiating with respect to $\vbq_-$ survives (or equivalently for $\boldsymbol{\pi}_+$). A more complete explanation of this process, along with a derivation can be found <span class="highlight-sh" title="Do not use 'in [X]': the syntax of a sentence should not be changed by the removal of a citation. [sh:c:noin]">in \cite{</span>galleyClassicalMechanicsNonconservative2013}.</div><div class="clear"></div>
<div class="linenb">&nbsp;89</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;90</div><div class="codeline">A corresponding form of Noether's theorem can be shown to hold for these non-conservative systems where the Noether currents evolve in time due to the effect of the non-conservative coupling potential $K$ \cite{galleyPrincipleStationaryNonconservative2014}.</div><div class="clear"></div>
<div class="linenb">&nbsp;91</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;92</div><div class="codeline"><span class="keyword1">\subsection</span>{The \SI}</div><div class="clear"></div>
<div class="linenb">&nbsp;93</div><div class="codeline"><span class="keyword1">\label</span>{sec:intro-si}</div><div class="clear"></div>
<div class="linenb">&nbsp;94</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;95</div><div class="codeline">The \SI{} is an adaption of a symplectic integrators to non-conservative Lagrangian mechanics, symplectic integrators being those which preserve the canonical symplectic 2-form of the system $dp \wedge dq$ and thus preserve many desired properties in integration.</div><div class="clear"></div>
<div class="linenb">&nbsp;96</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;97</div><div class="codeline">Thus to understand the \SI{} method we first consider the application of a symplectic integrators to a traditional conservative system\footnote{This explanation takes its path from an unpublished paper by Tsang et al.\cite{tsangVariationalSymplecticIntegrators}}. As before consider a system with $N$ degrees of freedom represented by some $\vbq \in \R^N$. We take that this system is governed by some Lagrangian, $L(\vbq, \dot{\vbq}, t) \in \R$.</div><div class="clear"></div>
<div class="linenb">&nbsp;98</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;99</div><div class="codeline">With this setup we now choose to apply two successive procedures to our extremal path $\vb q(t)$, first piecewise breakdown and then discretisation of the action itself. It is this ordering that differentiates this symplectic method from more traditional integrators such as Runge-Kutta \cite{devriesFirstCourseComputational2011} (as can be seen in \fref{fig:integrator-compare}) which solve similar systems by discretising the final equations of motion rather than the action.</div><div class="clear"></div>
<div class="linenb">100</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">101</div><div class="codeline"><span class="keyword2">\begin{figure}</span>[t]</div><div class="clear"></div>
<div class="linenb">102</div><div class="codeline">  <span class="keyword1">\label</span>{<span class="highlight-sh" title="Figure fig:integrator-compare is never referenced in the text [sh:figref]">f</span>ig:integrator-compare}</div><div class="clear"></div>
<div class="linenb">103</div><div class="codeline">  <span class="keyword1">\includegraphics</span>[width=\columnwidth]{figures/dho_r_runtime_linear.pdf}</div><div class="clear"></div>
<div class="linenb">104</div><div class="codeline">  <span class="highlight-sh" title="A caption should end with a period [sh:capperiod]"><span class="keyword1">\caption</span>{TODO</span>}</div><div class="clear"></div>
<div class="linenb">105</div><div class="codeline"><span class="keyword2">\end{figure}</span></div><div class="clear"></div>
<div class="linenb">106</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">107</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">108</div><div class="codeline">To start we break the trajectory down piecewise into a collection of $M$ sub-paths $\gamma_{n \in [M - 1]}$ where $[A] = \set{0, \dots, A}$, each defined on some portion of the whole timespan $[t_n, t_{n + 1}] \subset [t_i, t_f] \subset \R$ such that they cover it completely with overlaps only at the boundaries of the intervals. These together are such that the there is the correspondence,</div><div class="clear"></div>
<div class="linenb">109</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">110</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">111</div><div class="codeline"><span class="keyword1">\label</span>{eq:pw-traj}</div><div class="clear"></div>
<div class="linenb">112</div><div class="codeline">	\vb q(t) = <span class="keyword2">\begin{cases}</span></div><div class="clear"></div>
<div class="linenb">113</div><div class="codeline">		\gamma_n(t) &amp;\text{for~} t \in [t_n, t_{n + 1}]</div><div class="clear"></div>
<div class="linenb">114</div><div class="codeline">	<span class="keyword2">\end{cases}</span></div><div class="clear"></div>
<div class="linenb">115</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">116</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">117</div><div class="codeline">for all $t \in [t_i, t_f]$. These paths define a collection of points $\vb q_{n \in [M]}$ which are their mutual values at the piecewise break points and the initial and final values for $n = 0$ and $n = M$ respectively.</div><div class="clear"></div>
<div class="linenb">118</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">119</div><div class="codeline">As each piecewise curve constitutes in and of itself a physically attained trajectory we can state that any path $\vb{q}(t)$ which extremises the action for the whole timespan, must also extremise each piecewise portion, and visa-versa. </div><div class="clear"></div>
<div class="linenb">120</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">121</div><div class="codeline">This does not bring us closer to a numerical solution directly but allows us to freely split our integral domain as needed without loss of accuracy, and thus limit the error of our numerical-integration method which will necessarily increase with the number of time-steps or their size.</div><div class="clear"></div>
<div class="linenb">122</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">123</div><div class="codeline">We now turn to the discretisation method itself. This is done using the Galerkin-Gauss-Lobatto (GGL) quadrature method of order $r \in \N_0$\cite{tsangSLIMPLECTICINTEGRATORSVARIATIONAL2015, farrVariationalIntegratorsGravitational2007} which approximates the integral from $t_n$ to $t_{n + 1}$ using the intermediary points</div><div class="clear"></div>
<div class="linenb">124</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">125</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">126</div><div class="codeline">  t^{(i)}_n = t_n + (1 + x_i)\frac{\Delta t}{2}</div><div class="clear"></div>
<div class="linenb">127</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">128</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">129</div><div class="codeline"><span class="comment"><span class="comment">% NOTE: Orders defined here</span></span></div><div class="clear"></div>
<div class="linenb">130</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">131</div><div class="codeline">where $i \in [r + 1]$ and $x_i$ are the ordered roots of the the derivative of the $(r + 1)$th Legendre polynomial $P_{r + 1}$ and $\Delta t = t_f - t_i$. For a given choice of $r$ this provides slimpletic maps that are accurate up an order $2r + 2$. In turn we also define the interior points $\vbq_n^{(i)} = \vbq(t^{(i)}_n)$ to each piecewise trajectory.</div><div class="clear"></div>
<div class="linenb">132</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">133</div><div class="codeline">These allow us to approximate the path of the system within this quadrature using the associated cardinal functions for the GGL quadrature, labelled $\phi(t)$, as \(\vb q(t) = \phi(t) + \Or((\Delta t)^{r + 2})\). These provide a suitable approximation for the path derivative $\dot{\vb q}$ by the use the derivative matrix,</div><div class="clear"></div>
<div class="linenb">134</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">135</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">136</div><div class="codeline"><span class="keyword1">\label</span>{eq:dij}</div><div class="clear"></div>
<div class="linenb">137</div><div class="codeline">  D_{ij} = <span class="keyword2">\begin{cases}</span></div><div class="clear"></div>
<div class="linenb">138</div><div class="codeline">  	\dfrac{(r + 1)(r + 2)}{2\Delta t} &amp;i = j = 0 \\\\</div><div class="clear"></div>
<div class="linenb">139</div><div class="codeline">  	-\dfrac{(r + 1)(r + 2)}{2\Delta t} &amp; i = j = r + 1 \\\\</div><div class="clear"></div>
<div class="linenb">140</div><div class="codeline">  	0 &amp; i = j \land i \notin \set{0, r + 1} \\\\</div><div class="clear"></div>
<div class="linenb">141</div><div class="codeline">  	\dfrac{2P_{r + 1}(x_i)}{P_{r+1}(x_j)(x - x_j)\Delta t} &amp; i\neq j</div><div class="clear"></div>
<div class="linenb">142</div><div class="codeline">  <span class="keyword2">\end{cases}</span></div><div class="clear"></div>
<div class="linenb">143</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">144</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">145</div><div class="codeline">which provides that,</div><div class="clear"></div>
<div class="linenb">146</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">147</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">148</div><div class="codeline">  \dot\phi(t_n^{(i)}) = \sum_{j = 0}^{r + 1} D_{ij}q_n^{(j)}</div><div class="clear"></div>
<div class="linenb">149</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">150</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">151</div><div class="codeline">In turn this allows to express the integral as,</div><div class="clear"></div>
<div class="linenb">152</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">153</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">154</div><div class="codeline"><span class="keyword1">\label</span>{eq:discr-action-1}</div><div class="clear"></div>
<div class="linenb">155</div><div class="codeline">  \int_{t_n}^{t_{n + 1}} L(\vb q, \dot{\vb q}, t) \dd t \approx \sum_{i = 0}^{r + 1} w_i L(q_{n}^{(i)}, \dot\phi_{n}^{(i)}, t_{n}^{(i)})</div><div class="clear"></div>
<div class="linenb">156</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">157</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">158</div><div class="codeline">where the label the approximate expression $L_d^n$ and where $w_i$ are the quadrature weights given by</div><div class="clear"></div>
<div class="linenb">159</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">160</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">161</div><div class="codeline">  w_i = \frac{\Delta t}{(r + 1)(r + 2)(P_{r + 1}(x_i))^2}</div><div class="clear"></div>
<div class="linenb">162</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">163</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">164</div><div class="codeline">Equation \eqref{eq:discr-action-1} strung together across the different piecewise sub-trajectories defined in equation \eqref{eq:pw-traj} gives us the total discretised action of the system, shown in Equation \eqref{eq:discr-action-2}, that sets sympletic integrators apart from their more general counterparts. </div><div class="clear"></div>
<div class="linenb">165</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">166</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">167</div><div class="codeline"><span class="keyword1">\label</span>{eq:discr-action-2}</div><div class="clear"></div>
<div class="linenb">168</div><div class="codeline">  S_d = \sum_{n = 0}^{M} \sum_{i = 0}^{r + 1} w_i L(q_{n}^{(i)}, \dot\phi_{n}^{(i)}, t_{n}^{(i)})</div><div class="clear"></div>
<div class="linenb">169</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">170</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">171</div><div class="codeline">From here we then extremise this approximate path with respect to the mutual and interior points to obtain the equations of motion of the system as,</div><div class="clear"></div>
<div class="linenb">172</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">173</div><div class="codeline"><span class="keyword2">\begin{gather}</span></div><div class="clear"></div>
<div class="linenb">174</div><div class="codeline">	\frac{\p L_d^{n-1}}{\p q_n} + \frac{\p L_d^{n}}{\p q_n} = 0 <span class="highlight-sh" title="You should not break lines manually in a paragraph. Either start a new paragraph or stay in the current one. [sh:nobreak]">\</span>\</div><div class="clear"></div>
<div class="linenb">175</div><div class="codeline">	<span class="keyword1">\label</span>{eq:Ld-interior-eom} \frac{\p L_d^{n}}{\p q^{(i)}_n} = 0</div><div class="clear"></div>
<div class="linenb">176</div><div class="codeline"><span class="keyword2">\end{gather}</span></div><div class="clear"></div>
<div class="linenb">177</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">178</div><div class="codeline">where $L_d^{n}$ is This first equation can be simplified further into two equivalent definitions for the discrete momentum \(\pi_n\),</div><div class="clear"></div>
<div class="linenb">179</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">180</div><div class="codeline"><span class="keyword2">\begin{align}</span></div><div class="clear"></div>
<div class="linenb">181</div><div class="codeline">	<span class="keyword1">\label</span>{eq:pi-n} \pi_n &amp;= -\frac{\p L_d^{n}}{\p q_n} \\</div><div class="clear"></div>
<div class="linenb">182</div><div class="codeline">	<span class="keyword1">\label</span>{eq:pi-n+1} \pi_{n + 1} &amp;= \frac{\p L_d^{n}}{\p q_{n + 1}}</div><div class="clear"></div>
<div class="linenb">183</div><div class="codeline"><span class="keyword2">\end{align}</span></div><div class="clear"></div>
<div class="linenb">184</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">185</div><div class="codeline">and a continuity constraint at these mutual overlap points $\vb q_n$ in the same manner as we required for $\vb q_n$ itself. Together Equations \eqref{eq:Ld-interior-eom}, \eqref{eq:pi-n} can be solved to determine the values of $\vb q^{(i)}_n$, from which Equation \eqref{eq:pi-n+1} provides a form for determining $\pi_{n + 1}$.</div><div class="clear"></div>
<div class="linenb">186</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">187</div><div class="codeline">This form is provided in terms of the traditional conservative Lagrangian $L$ however can be readily adapted to the non-conservative Lagrangian formalism discussed in \sref{sec:intro-nc-actions} by considering instead the non-conservative Euler-Lagrange Equation \eqref{eq:nc-el}, in effect substituting $L$ for the non-conservative Lagrangian $\Lambda$ and $\vb q_n$ for $\vb q_{n, -}$.</div><div class="clear"></div>
<div class="linenb">188</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">189</div><div class="codeline">Continuing the consideration of Noether currents from prior sections, it can be shown that the continuous symmetries of the conservative action evolve as due to this now discretised $K_d$. It should be noted that GGL discretisation does not preserve time-shift symmetry, and hence energy is non conserved under the operation, however we will show, in line with previous work \cite{tsangSLIMPLECTICINTEGRATORSVARIATIONAL2015}, that the fractional error is generally bounded over the integration.</div><div class="clear"></div>
<div class="linenb">190</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">191</div><div class="codeline"><span class="keyword1">\subsection</span>{Physics Informed Neural Networks}</div><div class="clear"></div>
<div class="linenb">192</div><div class="codeline"><span class="keyword1">\label</span>{sec:intro-pinn}</div><div class="clear"></div>
<div class="linenb">193</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">194</div><div class="codeline">Physics informed neural networks (PINNs) are neural networks which include physical knowledge in their training processes \cite{raissiPhysicsInformedDeep2017}. Their most common application is to solving PDEs \cite{luDeepXDEDeepLearning2021,mengCompositeNeuralNetwork2020} where we take physically derived knowledge of the system as a prior in training and fit a neural network to solve some PDE incorporating the residuals into the models loss (loss functions will be discussed in more depth in \sref{sec:intro-lf}).</div><div class="clear"></div>
<div class="linenb">195</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">196</div><div class="codeline">Neural networks more generally are a collection of linear and non-linear components composed together to form complex non-linear functions. At their base level the linear components can be expressed as the simple linear equation \(\vb{y} = W\vb{x} + \vb{b}\) where $W$ is a collection of weights for this component and $\vb{b}$ the biases; and the non-linear components are functions such as sigmoid or $\tanh$ which are included to stop collapse to linearity for the whole composition. These weights, biases, and other variables within the model constitute the model's <span class="keyword1">\emph</span>{parameters}.</div><div class="clear"></div>
<div class="linenb">197</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">198</div><div class="codeline">This composition is useful in that it can be shown that, with sufficient complexity, these forms are dense in the space of Borel measurable functions and hence can take the place of almost any physical function or mathematical procedure \cite{hornikMultilayerFeedforwardNetworks1989}.</div><div class="clear"></div>
<div class="linenb">199</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">200</div><div class="codeline"><span class="keyword1">\subsection</span>{Loss functions}</div><div class="clear"></div>
<div class="linenb">201</div><div class="codeline"><span class="keyword1">\label</span>{sec:intro-lf}</div><div class="clear"></div>
<div class="linenb">202</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">203</div><div class="codeline">Loss functions are the primary leaning method of neural networks and in PINNs act as the place where physics steps in to connect our computational model to reality. Loss functions work by attempting to minimise an arbitrary loss value computed from the parameters and a large dataset of known inputs and outputs for the model.</div><div class="clear"></div>
<div class="linenb">204</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">205</div><div class="codeline">A loss function traditionally takes the form, $\mathrm{loss} = f(y_{\text{true}}, y_{\text{pred}})$ where $f$ is some chosen function and $y_{\text{pred}}$ and $y_{\text{true}}$ are both real vectors in the output space of the model, representing the known models output and the known true output respectively.</div><div class="clear"></div>
<div class="linenb">206</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">207</div><div class="codeline">Loss functions in PINNs are often comprised of two components. First there is the prediction or physical loss which may for example be made up of the residuals of the model under PDE, boundary, and initial conditions of the system. Secondly there a regularisation loss term which helps to penalise overfitting to the training data, expressed as \enquote{complexity}, within the model. This might be implemented as an $L^2$  of a vector containing all parameters of the model.</div><div class="clear"></div>
<div class="linenb">208</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">209</div><div class="codeline">Optimising this loss function can be thought of as a traditional minimisation problem, with common choices of the method being Stochastic gradient descent and Ada<span class="highlight-sh" title="Add a space before citation or reference. [sh:c:001]">m\cite</span>{kingmaAdamMethodStochastic2017}. These impose various requirements on the loss function, for example generally that it is differentiable\footnote{Although methods exist for non-differentiable functions \cite{daubechiesIterativeThresholdingAlgorithm2003}.} and benefits from other properties such as higher-order differentiability, Lipschitz continuity, and convexit<span class="highlight-sh" title="Add a space before citation or reference. [sh:c:001]">y\cite</span>{sraOptimizationMachineLearning2012}. The rate at which these methods apply gradient based updates is determined a provided learning rate, which will often be varied through training to quickly move towards minima during the initial stages, then tuned down to avoid \enquote{jumping} over the minima as we close in on the optimal solution.</div><div class="clear"></div>
<div class="linenb">210</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">211</div><div class="codeline"><span class="keyword1">\subsection</span>{Lagrangian Embeddings}</div><div class="clear"></div>
<div class="linenb">212</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">213</div><div class="codeline">Dealing computationally with non-conservative Lagrangians $\Lambda$, for example as an output of a PINN, requires defining some mapping from a collection of real 	numbers, to a form of $\Lambda(\vbq, \dot\vbq, t)$. This can be thought of as a function,</div><div class="clear"></div>
<div class="linenb">214</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">215</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">216</div><div class="codeline">  E: \R^n \to \mathbb{L}</div><div class="clear"></div>
<div class="linenb">217</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">218</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">219</div><div class="codeline">where $E$ is a chosen embedding function and $\mathbb{L}$ is a subset of the overall function space of possible $\Lambda$ values. The choice of embedding necessarily restricts and dictates the systems which the system can deal with thus its choice is crucial in the design of any system. Discussions of different embeddings used in this paper can be found in \sref{sec:eg-sys}. An embedding can either be chosen to represent a system specifically by its physical parameters, or by some arbitrary function approximation scheme such as Fourier series or Taylor expansions.</div><div class="clear"></div>
<div class="linenb">220</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">221</div><div class="codeline">It should be noted that these embeddings often will not have a unique correspondence with physical Lagrangians, ie the map is not injective up to physical behaviour. This has implications for optimisation in creating multiple minima as will be discussed.</div><div class="clear"></div>
<div class="linenb">222</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">223</div><div class="codeline"><span class="keyword1">\subsection</span>{Automatic-Differentiation, XLA, and Google's JAX}</div><div class="clear"></div>
<div class="linenb">224</div><div class="codeline"><span class="keyword1">\label</span>{sec:intro-autodiff}</div><div class="clear"></div>
<div class="linenb">225</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">226</div><div class="codeline">Automatic-differentiation is the process of computing the differential of \enquote{regular} code, ie. code that is substantially similar to code that one would normally write, with respect to one or more of its arguments. Google's JAX library \cite{jax2018github} contains one implementation of this in Python which works by passing \enquote{tracers} into the Python code which record the actions done to them such that a differential can be calculated.</div><div class="clear"></div>
<div class="linenb">227</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">228</div><div class="codeline">JAX also incorporates the XLA (Accelerated Linear Algebra) library \cite{openxla-xla} where it uses similar tracing methods to translate a restricted, but large, subset of Python code into a series of low-level eifficent operations which can be executed at speed on the GPU or CPU.</div><div class="clear"></div>
<div class="linenb">229</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">230</div><div class="codeline">These two technologies together show great promise in the fields of machine learning and simulation techniques as they allow for code that would previously have to be written in low-level languages such as C or C++ to be expressed in Python with significantly reduced overhead at runtime, and easier use by researchers.</div><div class="clear"></div>
</div>
<hr/>
Output produced by TeXtidote v0.8.2, &copy; 2018-2020 Sylvain Hall&eacute; - All rights reserved.<br/>
See the <a href="https://sylvainhalle.github.io/textidote">TeXtidote website</a> for more information.
</body>
</html>
