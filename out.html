<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>TeXtidote analysis</title>
<style type="text/css">
body {
  font-family: sans-serif;
}
.highlight, .highlight-sh, .highlight-spelling {
  padding: 2pt;
  border-radius: 4pt;
  cursor: help;
  opacity: 0.7;
  border: dashed 1px;
}
.highlight {
  background-color: orange;
  color: black;
}
.highlight-sh {
  background-color: yellow;
  color: black;
}
.highlight-spelling {
  background-color: red;
  color: white;
}
div.original-file {
  font-family: monospace;
  font-size: 11pt;
  background-color: #f8f8ff;
  padding: 20pt;
  border-radius: 6pt;
}
.textidote {
  	background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiAgIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyIgICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgICB4bWxuczpzb2RpcG9kaT0iaHR0cDovL3NvZGlwb2RpLnNvdXJjZWZvcmdlLm5ldC9EVEQvc29kaXBvZGktMC5kdGQiICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiICAgd2lkdGg9IjEwMC4wOTEwNW1tIiAgIGhlaWdodD0iMTguMjA5MDk5bW0iICAgdmlld0JveD0iMCAwIDEwMC4wOTEwNSAxOC4yMDkwOTkiICAgdmVyc2lvbj0iMS4xIiAgIGlkPSJzdmc4IiAgIGlua3NjYXBlOnZlcnNpb249IjAuOTEgcjEzNzI1IiAgIHNvZGlwb2RpOmRvY25hbWU9InRleHRpZG90ZS5zdmciPiAgPGRlZnMgICAgIGlkPSJkZWZzMiIgLz4gIDxzb2RpcG9kaTpuYW1lZHZpZXcgICAgIGlkPSJiYXNlIiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiICAgICBib3JkZXJvcGFjaXR5PSIxLjAiICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIgICAgIGlua3NjYXBlOnpvb209IjEiICAgICBpbmtzY2FwZTpjeD0iLTI1NC4yNTMwOSIgICAgIGlua3NjYXBlOmN5PSItMjc4LjM3NTkxIiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9Im1tIiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIiAgICAgc2hvd2dyaWQ9ImZhbHNlIiAgICAgZml0LW1hcmdpbi10b3A9IjAiICAgICBmaXQtbWFyZ2luLWxlZnQ9IjAiICAgICBmaXQtbWFyZ2luLXJpZ2h0PSIwIiAgICAgZml0LW1hcmdpbi1ib3R0b209IjAiICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjE5MjAiICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSIxMDIxIiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjAiICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMjY1IiAgICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMSIgLz4gIDxtZXRhZGF0YSAgICAgaWQ9Im1ldGFkYXRhNSI+ICAgIDxyZGY6UkRGPiAgICAgIDxjYzpXb3JrICAgICAgICAgcmRmOmFib3V0PSIiPiAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+ICAgICAgICA8ZGM6dHlwZSAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4gICAgICAgIDxkYzp0aXRsZSAvPiAgICAgIDwvY2M6V29yaz4gICAgPC9yZGY6UkRGPiAgPC9tZXRhZGF0YT4gIDxnICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIgICAgIGlua3NjYXBlOmdyb3VwbW9kZT0ibGF5ZXIiICAgICBpZD0ibGF5ZXIxIiAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI5LjczODA5NSwtNzAuNTc3NzUxKSI+ICAgIDxnICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zaXplOjIwLjkyODk0NTU0cHg7bGluZS1oZWlnaHQ6MS4yNTtmb250LWZhbWlseTpzYW5zLXNlcmlmO2xldHRlci1zcGFjaW5nOjBweDt3b3JkLXNwYWNpbmc6MHB4O2ZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45Nzc1MzgyMztzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIgICAgICAgaWQ9InRleHQ4MzYiPiAgICAgIDxwYXRoICAgICAgICAgZD0ibSAzMC43MjY4NjQsNzEuNTY2NTIgNS4yMzIyMzYsMCAwLDQuMjA5MDQ0IDUuODEzNTk2LDAgMCwzLjYwNDQyOSAtNS44MTM1OTYsMCAwLDQuODEzNjU4IDUuODEzNTk2LDAgMCwzLjYwNDQyOSAtMTEuMDQ1ODMyLDAgMCwtMTYuMjMxNTYgeiIgICAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LWZhbWlseTpUdXRvcjstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOlR1dG9yO2ZpbGw6I2ZmZmZmZjtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45Nzc1MzgyMztzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIgICAgICAgICBpZD0icGF0aDMzODYiIC8+ICAgICAgPHBhdGggICAgICAgICBkPSJtIDQyLjMzNTg4OCw3NS43NzU1NjQgMTEuMDQ1ODMyLDAgMCw3LjgxMzQ3MyAtNS44MTM1OTYsMCAwLDAuNjA0NjE0IDUuODEzNTk2LDAgMCwzLjYwNDQyOSAtMTEuMDQ1ODMyLDAgMCwtMTIuMDIyNTE2IHogbSA1LjIzMjIzNiw0LjIwOTA0MyAwLjU4MTM2LDAgMCwtMC42MDQ2MTQgLTAuNTgxMzYsMCAwLDAuNjA0NjE0IHoiICAgICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7Zm9udC1mYW1pbHk6VHV0b3I7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpUdXRvcjtmaWxsOiNmZmZmZmY7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTc3NTM4MjM7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmUiICAgICAgICAgaWQ9InBhdGgzMzg4IiAvPiAgICAgIDxwYXRoICAgICAgICAgZD0ibSA1My45NDQ5MTIsNzUuNzc1NTY0IDUuMjMyMjM2LDAgMCwzLjYwNDQyOSAtNS4yMzIyMzYsMCAwLC0zLjYwNDQyOSB6IG0gNS44MTM1OTYsMCA1LjIzMjIzNiwwIDAsMy42MDQ0MjkgLTUuMjMyMjM2LDAgMCwtMy42MDQ0MjkgeiBtIC01LjgxMzU5Niw4LjQxODA4NyA1LjIzMjIzNiwwIDAsMy42MDQ0MjkgLTUuMjMyMjM2LDAgMCwtMy42MDQ0MjkgeiBtIDUuODEzNTk2LDAgNS4yMzIyMzYsMCAwLDMuNjA0NDI5IC01LjIzMjIzNiwwIDAsLTMuNjA0NDI5IHoiICAgICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7Zm9udC1mYW1pbHk6VHV0b3I7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpUdXRvcjtmaWxsOiNmZmZmZmY7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTc3NTM4MjM7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmUiICAgICAgICAgaWQ9InBhdGgzMzkwIiAvPiAgICAgIDxwYXRoICAgICAgICAgZD0ibSA2NS41NTM5MzYsNzEuNTY2NTIgNS4yMzIyMzYsMCAwLDQuMjA5MDQ0IDUuODEzNTk2LDAgMCwzLjYwNDQyOSAtNS44MTM1OTYsMCAwLDQuODEzNjU4IDUuODEzNTk2LDAgMCwzLjYwNDQyOSAtMTEuMDQ1ODMyLDAgMCwtMTYuMjMxNTYgeiIgICAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LWZhbWlseTpUdXRvcjstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOlR1dG9yO2ZpbGw6I2ZmZmZmZjtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45Nzc1MzgyMztzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIgICAgICAgICBpZD0icGF0aDMzOTIiIC8+ICAgICAgPHBhdGggICAgICAgICBkPSJtIDc3LjE2Mjk2LDc1Ljc3NTU2NCA1LjIzMjIzNiwwIDAsMTIuMDIyNTE2IC01LjIzMjIzNiwwIDAsLTEyLjAyMjUxNiB6IG0gMCwtNC4yMDkwNDQgNS4yMzIyMzYsMCAwLDMuNjA0NDMgLTUuMjMyMjM2LDAgMCwtMy42MDQ0MyB6IiAgICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtZmFtaWx5OlR1dG9yOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246VHV0b3I7ZmlsbDojZmZmZmZmO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk3NzUzODIzO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIiAgICAgICAgIGlkPSJwYXRoMzM5NCIgLz4gICAgICA8cGF0aCAgICAgICAgIGQ9Im0gODIuOTY3NDcyLDc1Ljc3NTU2NCA1LjgxMzU5NiwwIDAsLTQuMjA5MDQ0IDUuMjMyMjM2LDAgMCwxNi4yMzE1NiAtMTEuMDQ1ODMyLDAgMCwtMTIuMDIyNTE2IHogbSA1LjIzMjIzNiw4LjQxODA4NyAwLjU4MTM2LDAgMCwtNC44MTM2NTggLTAuNTgxMzYsMCAwLDQuODEzNjU4IHoiICAgICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7Zm9udC1mYW1pbHk6VHV0b3I7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpUdXRvcjtmaWxsOiNmZmZmZmY7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTc3NTM4MjM7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmUiICAgICAgICAgaWQ9InBhdGgzMzk2IiAvPiAgICAgIDxwYXRoICAgICAgICAgZD0ibSA5NC41NzY0OTYsNzUuNzc1NTY0IDExLjA0NTgzNCwwIDAsMTIuMDIyNTE2IC0xMS4wNDU4MzQsMCAwLC0xMi4wMjI1MTYgeiBtIDUuMjMyMjM3LDguNDE4MDg3IDAuNTgxMzU3LDAgMCwtNC44MTM2NTggLTAuNTgxMzU3LDAgMCw0LjgxMzY1OCB6IiAgICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtZmFtaWx5OlR1dG9yOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246VHV0b3I7ZmlsbDojZmZmZmZmO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk3NzUzODIzO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIiAgICAgICAgIGlkPSJwYXRoMzM5OCIgLz4gICAgICA8cGF0aCAgICAgICAgIGQ9Im0gMTA2LjE4NTUyLDcxLjU2NjUyIDUuMjMyMjQsMCAwLDQuMjA5MDQ0IDUuODEzNTksMCAwLDMuNjA0NDI5IC01LjgxMzU5LDAgMCw0LjgxMzY1OCA1LjgxMzU5LDAgMCwzLjYwNDQyOSAtMTEuMDQ1ODMsMCAwLC0xNi4yMzE1NiB6IiAgICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtZmFtaWx5OlR1dG9yOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246VHV0b3I7ZmlsbDojZmZmZmZmO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk3NzUzODIzO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIiAgICAgICAgIGlkPSJwYXRoMzQwMCIgLz4gICAgICA8cGF0aCAgICAgICAgIGQ9Im0gMTE3Ljc5NDU0LDc1Ljc3NTU2NCAxMS4wNDU4NCwwIDAsNy44MTM0NzMgLTUuODEzNiwwIDAsMC42MDQ2MTQgNS44MTM2LDAgMCwzLjYwNDQyOSAtMTEuMDQ1ODQsMCAwLC0xMi4wMjI1MTYgeiBtIDUuMjMyMjQsNC4yMDkwNDMgMC41ODEzNiwwIDAsLTAuNjA0NjE0IC0wLjU4MTM2LDAgMCwwLjYwNDYxNCB6IiAgICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtZmFtaWx5OlR1dG9yOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246VHV0b3I7ZmlsbDojZmZmZmZmO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk3NzUzODIzO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIiAgICAgICAgIGlkPSJwYXRoMzQwMiIgLz4gICAgPC9nPiAgPC9nPjwvc3ZnPg==);
}
h2.filename {
  font-family: monospace;
}
h1.textidote {
  width: 378px;
  height: 68px;
  display: block;
}
.keyword1 {
  font-weight: bold;
  color: green;
}
.keyword2 {
  font-weight: bold;
  color: darkblue;
}
.comment, .comment * {
  color: darkred;
  font-weight: normal;
}
.linenb {
  font-style: italic;
  color: lightgrey;
  width: 30pt;
  float: left;
  margin-top: 1pt;
  margin-bottom: 1pt;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.codeline {
  margin-left: -30pt;
  padding-left: 60pt;
  margin-top: 1pt;
  margin-bottom: 1pt;
}
.no-text {
  display: none;
}
.clear {
  clear: both;
}
</style>
</head>
<body>
<a href="https://sylvainhalle.github.io/textidote"><h1 class="textidote"><span class="no-text">Results of TeXtidote analysis</span></h1></a>
<p>Here is the result of analyzing your file(s) with TeXtidote. Hover the mouse over highlighted portions of the document to read a tooltip that gives you some writing advice.</p>
<h2 class="filename">report.tex</h2>

<p>Found 6 warning(s)</p>
<div class="original-file">
<div class="linenb">&nbsp;1</div><div class="codeline"><span class="keyword1">\documentclass</span>[10pt]{iopart}</div><div class="clear"></div>
<div class="linenb">&nbsp;2</div><div class="codeline">\input{setup}</div><div class="clear"></div>
<div class="linenb">&nbsp;3</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;4</div><div class="codeline">\def\SI{Slimplectic Integrator}</div><div class="clear"></div>
<div class="linenb">&nbsp;5</div><div class="codeline">\def\SymI{{Symplectic integrator}}</div><div class="clear"></div>
<div class="linenb">&nbsp;6</div><div class="codeline">\newcommand{\autodiff}{automatic-differentiation}</div><div class="clear"></div>
<div class="linenb">&nbsp;7</div><div class="codeline">\def\vbq{\vb{q}}</div><div class="clear"></div>
<div class="linenb">&nbsp;8</div><div class="codeline">\newcommand{\orgimpl}{<span class="keyword1">\textit</span>{original implementation}}</div><div class="clear"></div>
<div class="linenb">&nbsp;9</div><div class="codeline">\newcommand{\updimpl}{<span class="keyword1">\textit</span>{updated implementation}}</div><div class="clear"></div>
<div class="linenb">10</div><div class="codeline">\newcommand{\Niter}{N_{\mathrm{iter}}}</div><div class="clear"></div>
<div class="linenb">11</div><div class="codeline">\newcommand{\etall}{{\it et al.~\/}\ }</div><div class="clear"></div>
<div class="linenb">12</div><div class="codeline">\newcommand{\ensquote}[1]{`{#1}'}</div><div class="clear"></div>
<div class="linenb">13</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">14</div><div class="codeline"><span class="keyword2">\begin{document}</span></div><div class="clear"></div>
<div class="linenb">15</div><div class="codeline">\<span class="highlight-spelling" title="Possible spelling mistake found. (1) [lt:en:MORFOLOGIK_RULE_EN_GB]">ioptwocol</span><span class="highlight" title="Don't put a space after the opening parenthesis.. Suggestions: [[] (10) [lt:en:COMMA_PARENTHESIS_WHITESPACE]">[</span>{</div><div class="clear"></div>
<div class="linenb">16</div><div class="codeline"><span class="keyword1">\title</span>{Iterations on the Slimplectic integrator and its applications to physically informed loss functions}</div><div class="clear"></div>
<div class="linenb">17</div><div class="codeline">\author{J D <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [Coles, Coles X] (116) [lt:en:MORFOLOGIK_RULE_EN_GB]"></span>Coles$^1$}</div><div class="clear"></div>
<div class="linenb">18</div><div class="codeline">\address{$^1$ Department of Physics, University of Bath, Claverton Down, Bath BA2 7AY, UK}</div><div class="clear"></div>
<div class="linenb">19</div><div class="codeline"><span class="keyword2">\begin{abstract}</span></div><div class="clear"></div>
<div class="linenb">20</div><div class="codeline">The Slimplectic Integrator developed by Tsang <span class="keyword1">\textit</span>{<span class="highlight-sh" title="Use a backslash, comma, or tilde after the period; otherwise LaTeX will think it is a full stop ending a sentence. [sh:010]">et al.}</span>\ [1] provides fractional error bounds when integrating non-conservative Lagrangian systems. In this paper, we present iterations on this method using modern computational techniques improving its computational performance by a factor of $\approx 10^4$, with a small fixed cost, for long-term integrations on the order of $\Niter \approx 10^6$ and orders $r &lt; 40$. We present applications of this work to physically informed loss functions for identifying physical systems from observational data and use these in the training of a physics-informed neural network. This network, when trained on damped harmonic oscillators, predicts Lagrangians that are accurate to an absolute RMS error of $\pm 5 \times 10^{-2}$ in $\vbq$ and $\pm 1 \times 10 ^{-1}$ in $\pi$.</div><div class="clear"></div>
<div class="linenb">21</div><div class="codeline"><span class="keyword2">\end{abstract}</span></div><div class="clear"></div>
<div class="linenb">22</div><div class="codeline">}<span class="highlight" title="Don't put a space before the closing parenthesis.. Suggestions: []] (925) [lt:en:COMMA_PARENTHESIS_WHITESPACE]"></span>]</div><div class="clear"></div>
<div class="linenb">23</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">24</div><div class="codeline">\input{1-intro-prelim.tex}</div><div class="clear"></div>
<div class="linenb">25</div><div class="codeline">\input{2-method.tex}</div><div class="clear"></div>
<div class="linenb">26</div><div class="codeline">\input{3-results-discussion.tex}</div><div class="clear"></div>
<div class="linenb">27</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">28</div><div class="codeline">\ack</div><div class="clear"></div>
<div class="linenb">29</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">30</div><div class="codeline">My gratitude is given to my project partner <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [Angus] (982) [lt:en:MORFOLOGIK_RULE_EN_GB]">Aengus</span> Roberts who was a guiding light throughout the project, and who spent many hours designing, training and monitoring the network. Without him, this would not have been possible. I would also like to thank Dr David Tsang for his constant support and discussion as we have moved through this project. </div><div class="clear"></div>
<div class="linenb">31</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">32</div><div class="codeline"><span class="keyword1">\section</span>*{References}</div><div class="clear"></div>
<div class="linenb">33</div><div class="codeline">\bibliographystyle{iopart-num}</div><div class="clear"></div>
<div class="linenb">34</div><div class="codeline">\bibliography{references,static}</div><div class="clear"></div>
<div class="linenb">35</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">36</div><div class="codeline"><span class="keyword2">\end{document}</span></div><div class="clear"></div>
</div>
<h2 class="filename">results-pinn.tex</h2>

<p>Found 6 warning(s)</p>
<div class="original-file">
<div class="linenb">&nbsp;1</div><div class="codeline"><span class="keyword1">\subsection</span>{PINNs and Approximating Damped Harmonic Oscillators}</div><div class="clear"></div>
<div class="linenb">&nbsp;2</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;3</div><div class="codeline">Finally, we applied these techniques to a PINN. For our initial explorations in this space, we focused on fitting to systems of damped harmonic oscillators as has been the through line of the work thus far. We chose the 3-parameter DHO embedding over the 4-parameter embedding with a pre-factor as while DHO 4 was more effective when subject to direct gradient descent, we were concerned that the additional redundant embedding parameter would make learning the systems more complex and error-prone.</div><div class="clear"></div>
<div class="linenb">&nbsp;4</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;5</div><div class="codeline">The dataset used in training ($N \approx 5 \times 10^5$) was a mixed selection. Primarily it <span class="highlight" title="Did you mean 'comprised' or 'consisted of' or 'was composed of'?. Suggestions: [comprised, consisted of, was composed of] (623) [lt:en:COMPRISED_OF]">was comprised of</span> uniformly distributed embeddings within the subset of the physical region of the embedding space (positive embedding values). In <span class="highlight" title="A comma may be missing after the conjunctive/linking adverb 'addition'.. Suggestions: [addition,] (769) [lt:en:SENT_START_CONJUNCTIVE_LINKING_ADVERB_COMMA]">addition</span> a fraction, approximately $5 \%$ for both, of the spring and damping constants were set to zero to ensure that the model was exposed to non-damped simple harmonic motion and kinetic energy only systems.</div><div class="clear"></div>
<div class="linenb">&nbsp;6</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;7</div><div class="codeline">For PINN training, accounting for the increased complexity of the optimisation problem now being with respect to the parameters of the model, we made two alterations to our loss functions. First, we added a strong weight against non-physical negative embedding values in our loss function, taking the form of,</div><div class="clear"></div>
<div class="linenb">&nbsp;8</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;9</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">10</div><div class="codeline">  f(e_i) = <span class="keyword2">\begin{cases}</span></div><div class="clear"></div>
<div class="linenb">11</div><div class="codeline">  	0 &amp; e_i \ge \delta \\</div><div class="clear"></div>
<div class="linenb">12</div><div class="codeline">  	\exp{-\gamma e_i} &amp; e_i &lt; \delta </div><div class="clear"></div>
<div class="linenb">13</div><div class="codeline">  <span class="keyword2">\end{cases}</span></div><div class="clear"></div>
<div class="linenb">14</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">15</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">16</div><div class="codeline">where $\delta = −0.1$ is a tolerance to allow for zero to be a non-penalised output and $\gamma \approx 10$ is the strength of the penalisation. This was done as the non-physical behaviour of negative embedding values is less visible when considering the larger whole model optimisation <span class="highlight" title="This word has been used in one of the immediately preceding sentences. Using a synonym could make your text more interesting to read, unless the repetition is intentional.. Suggestions: [issue, concern, difficulty] (1544) [lt:en:EN_REPEATEDWORDS]">problem</span>.</div><div class="clear"></div>
<div class="linenb">17</div><div class="codeline">In addition, we also experimented with capping the values of the loss at large values to mitigate overflows when dealing with particularly bad fits, such as the initially random initialised weights before any training had commenced. Both of these alterations notably improved training stability and decreased the probability of floating-point related errors.</div><div class="clear"></div>
<div class="linenb">18</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">19</div><div class="codeline">Model training was done in batches and was prone to explosion possibly due to the non-convexity in some regions as discussed in \sref{sec:<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [result, resale, resold, resell, resile, resole, RESF, RESIF] (2045) [lt:en:MORFOLOGIK_RULE_EN_GB]">res-lf}</span>. Overall it was found that training could be made more stable by increasing batch sizes to $512$ from $32$, and manually tweaking learning rates and loss weightings (for example between the $\vb q$ and $\pi$ RMS terms where more progress was made with weighting towards $\vbq$ error to counteract observed larger tendency for error in this term) as training progressed.</div><div class="clear"></div>
<div class="linenb">20</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">21</div><div class="codeline">Other loss functions, such as RMS in $\pi$ only (RMS-(0, 1) in \tref{table:optimisation-results}), were once again investigated. This initially looked promising, producing good losses on the order of $10^{-4}$, however on further inspection it was found that these resulted from a finding <span class="highlight" title="The plural noun 'minima' cannot be used with the article 'a'. Did you mean 'a false minimum' or 'false minima'?. Suggestions: [a false minimum, false minima] (2674) [lt:en:A_NNS]">a false minima</span> of $m \approx k \approx \lambda$, highlighting the complexity of the embedding space in representing physical systems. This also underlined the utility of the previous direct embedding space optimisation done prior in informing us about the behaviour of the loss function itself.</div><div class="clear"></div>
<div class="linenb">22</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">23</div><div class="codeline">By the training's conclusion we obtained an absolute RMS error of $\pm 5 \times 10^{-2}$ in $\vbq$ and $\pm 1 \times 10 ^{-1}$ in $\pi$. This model was able to predict systems with some accuracy, clearly able to fit to certain features as shown in \fref{fig:model-prediction}.</div><div class="clear"></div>
<div class="linenb">24</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">25</div><div class="codeline"><span class="keyword2">\begin{figure}</span>[t]</div><div class="clear"></div>
<div class="linenb">26</div><div class="codeline">  <span class="keyword1">\includegraphics</span>[width=\columnwidth]{figures/model-predictions.pdf}</div><div class="clear"></div>
<div class="linenb">27</div><div class="codeline">  <span class="keyword1">\caption</span>{A comparison of the behaviour of a Lagrangian embedding predicted by a PINN. True embedding, $(m = 6, k = 2, \lambda = 3)$, predicted embedding, $(m = 9.401553,  k = 3.3729377, \lambda = 3.9162085)$.}</div><div class="clear"></div>
<div class="linenb">28</div><div class="codeline">  <span class="keyword1">\label</span>{<span class="highlight-sh" title="Figure fig:model-prediction is never referenced in the text [sh:figref]">fig:model-prediction</span>}</div><div class="clear"></div>
<div class="linenb">29</div><div class="codeline"><span class="keyword2">\end{figure}</span></div><div class="clear"></div>
<div class="linenb">30</div><div class="codeline">&nbsp;</div><div class="clear"></div>
</div>
<h2 class="filename">results-si.tex</h2>

<p>Found 18 warning(s)</p>
<div class="original-file">
<div class="linenb">&nbsp;1</div><div class="codeline"><span class="keyword1">\subsection</span>{Improvements to the Slimplectic Integrator and their Physical Applications}</div><div class="clear"></div>
<div class="linenb">&nbsp;2</div><div class="codeline"><span class="keyword1">\label</span>{sec:results-si}</div><div class="clear"></div>
<div class="linenb">&nbsp;3</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;4</div><div class="codeline"><span class="keyword2">\begin{figure}</span>[t]</div><div class="clear"></div>
<div class="linenb">&nbsp;5</div><div class="codeline">  <span class="keyword1">\includegraphics</span>[width=\columnwidth]{figures/dho_energy_momenta_fractional_err.pdf}</div><div class="clear"></div>
<div class="linenb">&nbsp;6</div><div class="codeline">  <span class="keyword1">\caption</span>{A comparison of the error in the energy, top, and momenta, bottom, as a fraction of the known analytic solution of the system, of the \updimpl{} simulating a damped harmonic oscillator. One can observe that the fractional energy error is bounded and displays the oscillating behaviour that we expect from previous work, whereas the momenta error does not display such behaviour. This plot is based on its equivalent in the original paper \cite[<span class="highlight-sh" title="Do not refer to figures using hard-coded numbers. Use \ref instead. [sh:hcfig]">Figure 2</span>, bottom]{tsangSLIMPLECTICINTEGRATORSVARIATIONAL2015}.}</div><div class="clear"></div>
<div class="linenb">&nbsp;7</div><div class="codeline"><span class="keyword1">\label</span>{<span class="highlight-sh" title="Figure fig:dho_energy_bounds is never referenced in the text [sh:figref]">fig:dho_energy_bounds</span>}</div><div class="clear"></div>
<div class="linenb">&nbsp;8</div><div class="codeline"><span class="keyword2">\end{figure}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;9</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">10</div><div class="codeline">As discussed we first verify that the \updimpl{} retains the required fractional error bounds of the formal method. This can be seen in \fref{fig:<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [who, do, duo, DSO, doh, MHO, AHO, BHO, CHO, DBO, DCO, DDO, DFO, DHA, DHC, DHH, DHI, DHL, DHM, DHP, DHR, DHT, DJO, DMO, DO, DPO, DXO, DZO, Deo, Dhu, Dio, Doo, HO, WHO, dhow, dzho, dzo, ho, oho, pho, rho, d ho] (208) [lt:en:MORFOLOGIK_RULE_EN_GB]">dho</span>_energy_bounds} where the fractional error of the \updimpl{} with respect to that of the true analytic solution is compared directly against that of <span class="highlight-spelling" title="Possible spelling mistake found. (349) [lt:en:MORFOLOGIK_RULE_EN_GB]">Runge-Kutta</span> order 2 and 4. We clearly observe that the fractional energy error remains bounded across the timeframe of iteration.</div><div class="clear"></div>
<div class="linenb">11</div><div class="codeline">This successfully replicated the behaviour of the original implementation to an absolute root mean squared residual over the simulation duration of $\Delta = 1.42 \times 10^{-13}$ and $\Delta = 4.50 \times 10^{-12}$ for $r = 2$ and $r = 4$ respectively.</div><div class="clear"></div>
<div class="linenb">12</div><div class="codeline">This is not the case for the fractional momenta error however as fixed-time-step variational methods such as those implemented cannot be both <span class="highlight-spelling" title="Possible spelling mistake found. (803) [lt:en:MORFOLOGIK_RULE_EN_GB]">slimplectic-momentum</span> and momentum-energy preserving \cite{zhongLiePoissonHamiltonJacobiTheory1988}.</div><div class="clear"></div>
<div class="linenb">13</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">14</div><div class="codeline"><span class="keyword2">\begin{figure}</span>[t]</div><div class="clear"></div>
<div class="linenb">15</div><div class="codeline">  <span class="keyword1">\includegraphics</span>[width=\columnwidth]{figures/dho_n_runtime.pdf}</div><div class="clear"></div>
<div class="linenb">16</div><div class="codeline">  <span class="keyword1">\caption</span>{A comparison of running a damped harmonic oscillator system for various numbers of iterations, with $r = 2, \Delta t = 0.1$. The \updimpl{} runtime is split into two components where \ensquote{JIT time} represents the one-time fixed cost of compiling the function (see \sref{sec:intro-autodiff}) and \enquote{Computation time} represents the actual time spent on computation.</div><div class="clear"></div>
<div class="linenb">17</div><div class="codeline">  Each value is the mean of 4 runs, with the \orgimpl{} being cut off early due after $&gt; 20$ minutes runtime for the next sample.}</div><div class="clear"></div>
<div class="linenb">18</div><div class="codeline">  <span class="keyword1">\label</span>{<span class="highlight-sh" title="Figure fig:dho-n-runtime is never referenced in the text [sh:figref]">fig:dho-n-runtime</span>}</div><div class="clear"></div>
<div class="linenb">19</div><div class="codeline"><span class="keyword2">\end{figure}</span></div><div class="clear"></div>
<div class="linenb">20</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">21</div><div class="codeline"><span class="keyword2">\begin{figure}</span>[t]</div><div class="clear"></div>
<div class="linenb">22</div><div class="codeline">  <span class="keyword1">\includegraphics</span>[width=\columnwidth]{figures/dho_r_runtime.pdf}</div><div class="clear"></div>
<div class="linenb">23</div><div class="codeline">  <span class="keyword1">\caption</span>{A comparison of running a damped harmonic oscillator system for various values of $r$, the order of the GGL quadrature, with $\Niter = 500, \Delta t = 0.1$. Each result is the mean of 4 independent runs.</div><div class="clear"></div>
<div class="linenb">24</div><div class="codeline">	For both implementations, we split the overall time into setup and computation as changing the method order requires re-discretising the Lagrangian and thus non-trivial work under both implementations.}</div><div class="clear"></div>
<div class="linenb">25</div><div class="codeline">  <span class="keyword1">\label</span>{<span class="highlight-sh" title="Figure fig:dho-r-runtime is never referenced in the text [sh:figref]">fig:dho-r-runtime</span>}</div><div class="clear"></div>
<div class="linenb">26</div><div class="codeline"><span class="keyword2">\end{figure}</span></div><div class="clear"></div>
<div class="linenb">27</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">28</div><div class="codeline">Next, we explored the time complexity of the system in terms of the iteration count, $N_{\text{iter}}$, and GGL quadrature order, $r$. These are important to physical applications as they determine the limits of iteration accuracy when iterating over large timescales -- with error scaling as $(\Delta t)^{2r + 2}$ and total timeframe being $N_{\text{iter}} \Delta t$.</div><div class="clear"></div>
<div class="linenb">29</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">30</div><div class="codeline">Focusing first on the time complexity in $N_{\text{iter}}$ as shown in \fref{fig:<span class="highlight-spelling" title="Possible spelling mistake found. (1229) [lt:en:MORFOLOGIK_RULE_EN_GB]">dho-n-runtime}</span>, we note <span class="highlight" title="Possible typo: you repeated a word. Suggestions: [that] (1252) [lt:en:ENGLISH_WORD_REPEAT_RULE]">that that</span> the computation time of the \updimpl{} is much lower than that of <span class="highlight" title="A word may be missing after 'the'. (1318) [lt:en:THE_PUNCT]">the \orgimpl{},</span> with the \updimpl{} growing as $\Or((\Niter)^a)$ where $a = 1.0140 \pm 0.0042$. </div><div class="clear"></div>
<div class="linenb">31</div><div class="codeline">In addition, we note that the fixed cost JIT compilation remains roughly constant until $10^7$ iterations after which it begins to grow linearly.</div><div class="clear"></div>
<div class="linenb">32</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">33</div><div class="codeline">This pattern is seen also in \fref{fig:<span class="highlight-spelling" title="Possible spelling mistake found. (1532) [lt:en:MORFOLOGIK_RULE_EN_GB]">dho-r-runtime}</span> when investigating the time complexity in the order of the method. Again the JIT time remains roughly constant across the domain tested, and though it starts initially higher than <span class="highlight" title="There probably shouldn't be a space before the apostrophe.. Suggestions: [the's] (1726) [lt:en:APOS_SPACE_CONTRACTION]">the \orgimpl{}'s</span> setup costs, <span class="highlight" title="There probably shouldn't be a space before the apostrophe.. Suggestions: [the's] (1746) [lt:en:APOS_SPACE_CONTRACTION]">the \orgimpl{}'s</span> computation time quickly swamps this fixed cost.</div><div class="clear"></div>
<div class="linenb">34</div><div class="codeline">Similar to the behaviour in $\Niter$, the computation time for the \updimpl{} is also linear $r$, remaining insignificant in the overall runtime. This is in comparison with the \orgimpl{} where the setup time grows as $\Or(r^n)$ with $n = {2.31 \pm 0.15}$ and the computation time as $\Or(r^m)$ with $m={1.490 \pm 0.070}$.</div><div class="clear"></div>
<div class="linenb">35</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">36</div><div class="codeline">It should be noted that while increasing the order of the method will increase the precision, at higher orders we start encountering limitations with the fixed precision \texttt{float64} type used for calculation in the \updimpl{} compared to the arbitrary precision numerics employed in <span class="highlight" title="A word may be missing after 'the'. (2308) [lt:en:THE_SENT_END]"></span>the \orgimpl{}.</div><div class="clear"></div>
<div class="linenb">37</div><div class="codeline">Still, however, this represents an overall improvement in accuracy in physically meaningful simulations as the required precision could be more readily attained by decreasing $\Delta t$ rather than increasing $r$, avoiding the <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [blow-up, blow up] (2530) [lt:en:MORFOLOGIK_RULE_EN_GB]">blowup</span> of runtime observed in <span class="highlight" title="A word may be missing after 'the'. (2560) [lt:en:THE_PUNCT]">the \orgimpl{},</span> or the degradation of precision at high $r$ in <span class="highlight" title="A word may be missing after 'the'. (2611) [lt:en:THE_SENT_END]">the \updimpl{}.</span> This is discussed further in \sref{sec:<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [results, resultless] (2650) [lt:en:MORFOLOGIK_RULE_EN_GB]"></span>results-si}</div><div class="clear"></div>
</div>
<h2 class="filename">2-method.tex</h2>

<p>Found 16 warning(s)</p>
<div class="original-file">
<div class="linenb">&nbsp;1</div><div class="codeline"><span class="keyword1">\section</span>{Method}</div><div class="clear"></div>
<div class="linenb">&nbsp;2</div><div class="codeline"><span class="comment"><span class="comment">%<span class="keyword1">\subsection</span>{Example Systems}</span></span></div><div class="clear"></div>
<div class="linenb">&nbsp;3</div><div class="codeline"><span class="comment"><span class="comment">%<span class="keyword1">\label</span>{sec:eg-sys}</span></span></div><div class="clear"></div>
<div class="linenb">&nbsp;4</div><div class="codeline"><span class="comment"><span class="comment">%</span></span></div><div class="clear"></div>
<div class="linenb">&nbsp;5</div><div class="codeline"><span class="comment"><span class="comment">%When testing our model we employ a number of example systems to test various features of the integrator, in different physical scenarios. Each of these is also associated with a specific embedding.</span></span></div><div class="clear"></div>
<div class="linenb">&nbsp;6</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;7</div><div class="codeline"><span class="comment"><span class="comment">%<span class="keyword1">\subsubsection</span>{Damped Forced Harmonic Oscillators}</span></span></div><div class="clear"></div>
<div class="linenb">&nbsp;8</div><div class="codeline">\<span class="highlight-sh" title="Avoid stacked headings, i.e. consecutive headings without text in between. [sh:stacked]">subsection</span>{Damped Forced Harmonic Oscillators}</div><div class="clear"></div>
<div class="linenb">&nbsp;9</div><div class="codeline"><span class="keyword1">\label</span>{sec:eg-sys}</div><div class="clear"></div>
<div class="linenb">10</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">11</div><div class="codeline">The main physical system used in the testing, and evaluation, of our model is the damped forced harmonic oscillator. It is one of the simplest non-conservative systems, having a non-conservative Lagrangian given <span class="highlight-sh" title="Do not use 'by [X]': the syntax of a sentence should not be changed by the removal of a citation. [sh:c:noin]">by \cite{</span>galleyPrincipleStationaryNonconservative2014},</div><div class="clear"></div>
<div class="linenb">12</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">13</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">14</div><div class="codeline"><span class="keyword1">\label</span>{eq:dho-sys-embedding}</div><div class="clear"></div>
<div class="linenb">15</div><div class="codeline"><span class="keyword2">\begin{aligned}</span></div><div class="clear"></div>
<div class="linenb">16</div><div class="codeline">  \Lambda &amp;= L - K \\</div><div class="clear"></div>
<div class="linenb">17</div><div class="codeline">  L &amp;= \frac12 m\dot\vbq^2 - \frac12 m\dot\vbq -  \\</div><div class="clear"></div>
<div class="linenb">18</div><div class="codeline">  K &amp;= - \lambda\vbq_- \cdot \dot \vbq_+ + \vbq_- \cdot \vb{F}(t)</div><div class="clear"></div>
<div class="linenb">19</div><div class="codeline"><span class="keyword2">\end{aligned}</span></div><div class="clear"></div>
<div class="linenb">20</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">21</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">22</div><div class="codeline">for a system with mass $m$, spring constant $k$, damping constant $\lambda$ and time dependent force $\vb{F}(t)$. This corresponds with the standard equation of motion,</div><div class="clear"></div>
<div class="linenb">23</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">24</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">25</div><div class="codeline">  m \ddot{\vb x} + \lambda \ddot{\vb x} + k \vb x = \vb F(t).</div><div class="clear"></div>
<div class="linenb">26</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">27</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">28</div><div class="codeline"><span class="keyword1">\subsection</span>{Improvements to the \SI{} <span class="highlight" title="Typo. Did you mean 'end'?. Suggestions: [end] (437) [lt:en:AND_END]">and</span> their Physical Applications}</div><div class="clear"></div>
<div class="linenb">29</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">30</div><div class="codeline">Initially, the existing \texttt{<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [symplectic] (494) [lt:en:MORFOLOGIK_RULE_EN_GB]">slimplectic}</span> codebase from Tsang \<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [tall, stall, Etwall, et all] (527) [lt:en:MORFOLOGIK_RULE_EN_GB]">etall</span> \cite{originalCode}, which we will refer to as <span class="highlight" title="A word may be missing after 'the'. (564) [lt:en:THE_PUNCT]">the \orgimpl{},</span> was rewritten using the <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [TAX, MAX, JAW, WAX, AJAX, FAX, JAR, SAX, LAX, JAL, JAN, JAB, JAG, JAY, VAX, JAM, AAX, AX, BAX, DAX, EAX, JA, JAA, JAC, JAF, JAI, JAK, JAP, JPX, JSX, JAH, JAT, J AX, JA X, PAX] (594) [lt:en:MORFOLOGIK_RULE_EN_GB]">JAX</span> framework, known as <span class="highlight" title="A word may be missing after 'the'. (618) [lt:en:THE_SENT_END]">the \updimpl{}.</span> We chose two key metrics, run-time duration and accuracy, to judge our model against the \orgimpl{} and <span class="highlight-spelling" title="Possible spelling mistake found. (718) [lt:en:MORFOLOGIK_RULE_EN_GB]">Runge-Kutta</span> to various orders.</div><div class="clear"></div>
<div class="linenb">31</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">32</div><div class="codeline">First, to ensure that we maintained the error bounds expected for our model (as per \sref{sec:<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [intros, introns, introrse] (838) [lt:en:MORFOLOGIK_RULE_EN_GB]">intro-si}</span>) we compared the fractional energy and momentum error for <span class="highlight-spelling" title="Possible spelling mistake found. (905) [lt:en:MORFOLOGIK_RULE_EN_GB]">Runge-Kutta</span>, <span class="highlight" title="A word may be missing after 'the'. (918) [lt:en:THE_PUNCT]">the \orgimpl{},</span> and the \updimpl{} across the time evolution of a physical system.</div><div class="clear"></div>
<div class="linenb">33</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">34</div><div class="codeline">Next, we create two test cases to measure the performance of the integrator and its consequences on experimental capability. These were,</div><div class="clear"></div>
<div class="linenb">35</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">36</div><div class="codeline"><span class="keyword2">\begin{enumerate}</span></div><div class="clear"></div>
<div class="linenb">37</div><div class="codeline">	<span class="keyword1">\item</span> Modelling systems for different timespans varying the number of iterations performed by the integrator.</div><div class="clear"></div>
<div class="linenb">38</div><div class="codeline">	<span class="keyword1">\item</span> Modelling the same system across different orders of integration $r$ to determine how the order of our method affects the performance.</div><div class="clear"></div>
<div class="linenb">39</div><div class="codeline"><span class="keyword2">\end{enumerate}</span></div><div class="clear"></div>
<div class="linenb">40</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">41</div><div class="codeline">These are designed to test the scaling behaviours of our model to provide insight into its applicability to larger systems.</div><div class="clear"></div>
<div class="linenb">42</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">43</div><div class="codeline"><span class="keyword1">\subsection</span>{Applications to Loss Functions and Optimisation}</div><div class="clear"></div>
<div class="linenb">44</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">45</div><div class="codeline">Taking this \updimpl{} we then explore its different uses as a loss function for physical systems, in combination with different embedding functions.</div><div class="clear"></div>
<div class="linenb">46</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">47</div><div class="codeline">While these are distinct components of the model, they are heavily linked, as ideally, we would define the physical components of our loss function primarily in terms of the trajectories, rather than the values of the embedding vector for the non-conservative Lagrangian itself.</div><div class="clear"></div>
<div class="linenb">48</div><div class="codeline"><span class="highlight" title="A comma may be missing after the conjunctive/linking adverb 'Hence'.. Suggestions: [Hence,] (1956) [lt:en:SENT_START_CONJUNCTIVE_LINKING_ADVERB_COMMA]">Hence</span> the embedding function and Slimplectic integrator must be chained together, before the physical loss component, to provide it with the trajectories.</div><div class="clear"></div>
<div class="linenb">49</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">50</div><div class="codeline">We consider a number of choices for these two functions, comparing their behaviour near known minima, and looking for convexity and smoothness. In <span class="highlight" title="A comma may be missing after the conjunctive/linking adverb 'addition'.. Suggestions: [addition,] (2259) [lt:en:SENT_START_CONJUNCTIVE_LINKING_ADVERB_COMMA]">addition</span> we also empirically test the suitability of these spaces for optimisation, by directly performing gradient descent to the loss function + embedding composition attempting to converge to a known embedding.</div><div class="clear"></div>
<div class="linenb">51</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">52</div><div class="codeline">\<span class="highlight-sh" title="This section is very short (about 72 words). You should consider merging it with another section or make it longer. [sh:seclen]">subsection</span>{Loss Function in the Training of PINNs}</div><div class="clear"></div>
<div class="linenb">53</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">54</div><div class="codeline">Finally, we employ a loss and embedding function combination to <span class="highlight" title="A word may be missing after 'a'. (2578) [lt:en:THE_PUNCT]">a,</span> simplified, stand-in neural network, observing the correctness of the outputs.</div><div class="clear"></div>
<div class="linenb">55</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">56</div><div class="codeline">This model was based on the long short-term memory (LSTM) layer \cite{hochreiterLongShortTermMemory1997} which is frequently used in time-series analysis, and thus chosen as a suitable basis for our model. This involves generating large datasets of different physical systems within the domain of the chosen embedding as will be discussed.</div><div class="clear"></div>
</div>
<h2 class="filename">1-intro-prelim.tex</h2>

<p>Found 63 warning(s)</p>
<div class="original-file">
<div class="linenb">&nbsp;&nbsp;1</div><div class="codeline"><span class="keyword1">\section</span>{Introduction}</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;2</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;3</div><div class="codeline">Neural networks (<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [NHS, Nuns, CNS, DNS, NPS, NUS, Inns, NBS, NFS, NLS, PNS, MNS, ANS, BNS, ENS, FNS, HNS, INS, NAS, NCS, NDS, NGS, NNI, NNN, NNSA, NOS, NPNS, NS, NSS, NaNs, ONS, PNNS, RNS, SNS, TNS, WNS, Ans, Ins, Ns, CNNs, NRS, NTS, NYS, RNNs] (31) [lt:en:MORFOLOGIK_RULE_EN_GB]">NNs</span>) and other machine learning (ML) techniques are becoming an increasingly important tool in of modern research process. This is due to their wide application in data-intensive problems, and ability to make progress where prior computational methods have proved otherwise intractable.</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;4</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;5</div><div class="codeline">The primary method of training ML models involves the construction of a loss function or equivalently a reward function, framing the training process as a high-dimensionality optimisation <span class="highlight" title="This word has been used in one of the immediately preceding sentences. Using a synonym could make your text more interesting to read, unless the repetition is intentional.. Suggestions: [issue, concern, difficulty] (507) [lt:en:EN_REPEATEDWORDS]">problem</span>.</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;6</div><div class="codeline">In this setting, the parameters of the model are varied such as to minimise the aggregate loss of the model's action, when taken over a large collection of inputs, compared to known corresponding outputs.</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;7</div><div class="codeline"><span class="highlight" title="A comma may be missing after the conjunctive/linking adverb 'Thus'.. Suggestions: [Thus,] (721) [lt:en:SENT_START_CONJUNCTIVE_LINKING_ADVERB_COMMA]">Thus</span> it is the loss function that grounds the model in a given <span class="highlight" title="This word has been used in one of the immediately preceding sentences. Using a synonym could make your text more interesting to read, unless the repetition is intentional.. Suggestions: [issue, concern, difficulty] (784) [lt:en:EN_REPEATEDWORDS]">problem</span>.</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;8</div><div class="codeline">The construction of loss functions varies across applications, but overall they exhibit some general characteristics as will be discussed.</div><div class="clear"></div>
<div class="linenb">&nbsp;&nbsp;9</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;10</div><div class="codeline">\SymI{}<span class="highlight" title="This sentence does not start with an uppercase letter.. Suggestions: [S] (933) [lt:en:UPPERCASE_SENTENCE_START]">s</span> are numerical integrators for Hamiltonian systems, which preserve the canonical symplectic 2-form of the system. </div><div class="clear"></div>
<div class="linenb">&nbsp;11</div><div class="codeline">This makes them widely applicable to physical fields such as orbital dynamics and molecular dynamics, among other<span class="highlight-sh" title="Add a space before citation or reference. [sh:c:001]">s\cite</span>{gladmanSymplecticIntegratorsLongterm1991,wisdomSymplecticMapsNbody1991}. Consequentially, they will preserve, or near preserve, the constants of motion of a system over <span class="highlight" title="Specify a number, remove phrase, or simply use 'many' or 'numerous'. Suggestions: [many, numerous] (1264) [lt:en:LARGE_NUMBER_OF]">a large number of</span> integration steps.</div><div class="clear"></div>
<div class="linenb">&nbsp;12</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;13</div><div class="codeline">The \SI{} (SI)\cite{tsangSLIMPLECTICINTEGRATORSVARIATIONAL2015} is a non-conservative extension of a symplectic integrator, which enables numerical integration of non-conservative systems. As with the symplectic integrators, this exhibits well-defined bounds in the fractional error of the energy, and other conserved quantities of the system. These are based on the non-conservative action approach developed by Galley \cite{galleyClassicalMechanicsNonconservative2013} and Galley \<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [tall, stall, Etwall, et all] (1687) [lt:en:MORFOLOGIK_RULE_EN_GB]">etall</span> \cite{galleyPrincipleStationaryNonconservative2014}.</div><div class="clear"></div>
<div class="linenb">&nbsp;14</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;15</div><div class="codeline">Automatic-differentiation techniques are a collection of computational methods for the determination of the derivatives of large classes of \ensquote{regular} scientific code, doing so in an efficient and accurate manner. In contrast, the \SI{} is currently implemented using computer algebra systems such as <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [SYMPA] (1992) [lt:en:MORFOLOGIK_RULE_EN_GB]">SymPy</span> \cite{sympy}, which represents and works with mathematical expressions symbolically, allowing for the computation of derivatives and integrals. These are general systems and are effective at working with a large range of expressions, but pose limitations when seeking to increase computational speed or to scale up to larger, more complex, physical systems.</div><div class="clear"></div>
<div class="linenb">&nbsp;16</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;17</div><div class="codeline">In this paper, we focus on taking the existing mathematical framework of the \SI{} and adapting it to use more advanced computational methods. In addition, making it amenable to \autodiff{} which enables a wide class of new applications.</div><div class="clear"></div>
<div class="linenb">&nbsp;18</div><div class="codeline">These include scaling to larger systems, for example in molecular dynamics and condensed matter simulations, to its use as the foundation of several physics-based loss functions. These loss functions will <span class="highlight" title="The modal verb 'will' requires the verb's base form.. Suggestions: [evaluate] (2775) [lt:en:MD_BASEFORM]">evaluated</span> for empirical and theoretical suitability, with the goal that these could be used in the creation of machine learning models which encode physical knowledge and insight, as discussed in the final part of the paper.</div><div class="clear"></div>
<div class="linenb">&nbsp;19</div><div class="codeline"><span class="comment"><span class="comment">%\todo{Maisy wants to change/qualify insight}</span></span></div><div class="clear"></div>
<div class="linenb">&nbsp;20</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;21</div><div class="codeline"><span class="keyword1">\section</span>{Preliminaries}</div><div class="clear"></div>
<div class="linenb">&nbsp;22</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;23</div><div class="codeline">\<span class="highlight-sh" title="Avoid stacked headings, i.e. consecutive headings without text in between. [sh:stacked]">subsection</span>{Lagrangian Mechanics}</div><div class="clear"></div>
<div class="linenb">&nbsp;24</div><div class="codeline"><span class="keyword1">\label</span>{sec:lag-mech}</div><div class="clear"></div>
<div class="linenb">&nbsp;25</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;26</div><div class="codeline"><span class="highlight" title="The genitive ('s) may be missing.. Suggestions: [Lagrangian's mechanics] (3039) [lt:en:MISSING_GENITIVE]">Lagrangian mechanics</span> is a formalism of classical mechanics which places emphasis on the energies and systems of the system and that allows flexibility in the exact variables used to parameterise the system.</div><div class="clear"></div>
<div class="linenb">&nbsp;27</div><div class="codeline">As it is traditionally phrased it works to solve the problem of determining the evolution of a physical system, parameterised by $n$ generalised degrees of freedom, represented as the vector $\vb q = \set{q_1, \dots, q_n} \in \R^n$, across the timespan $[t_i, t_f] \subset \R$ from some initially known configuration $\vb q_0 \in \R^n$. This determination is done by constructing a functional,</div><div class="clear"></div>
<div class="linenb">&nbsp;28</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;29</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;30</div><div class="codeline">  <span class="keyword1">\label</span>{eq:trad-action}</div><div class="clear"></div>
<div class="linenb">&nbsp;31</div><div class="codeline">  S[\vb{q}] = \int_{t_i}^{t_f} L(\vb{q}, \dot{\vb{q}}, t) \rdd t</div><div class="clear"></div>
<div class="linenb">&nbsp;32</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;33</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;34</div><div class="codeline">where $S$ is known as the action of the system, $\dot\vbq$ is the standard time derivative of the system's path, and $L$ the Lagrangian. The Lagrangian is traditionally made up of two components $T$, the kinetic energy of the system in some configuration at some time, and $V$, the potential energy of the system. These are combined as,</div><div class="clear"></div>
<div class="linenb">&nbsp;35</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;36</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;37</div><div class="codeline">  <span class="keyword1">\label</span>{eq:trad-lag}</div><div class="clear"></div>
<div class="linenb">&nbsp;38</div><div class="codeline">  L(\vb{q}, \dot{\vb{q}}, t) = T(\vb{q}, \dot{\vb{q}}, t) - V(\vb{q}, \dot{\vb{q}}, t).</div><div class="clear"></div>
<div class="linenb">&nbsp;39</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;40</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;41</div><div class="codeline">A physical solution is arrived at by then employing Hamilton's principle of least action \cite{goldsteinClassicalMechanics2000} which provides that the physical path, $\vb q(t)$, is the one that <span class="keyword1">\textit</span>{<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [extremists, extremisms, ext remises] (4035) [lt:en:MORFOLOGIK_RULE_EN_GB]">extremises}</span> the functional $S[\vb q]$ as defined in Equation \eqref{eq:trad-action}, <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [i.e., IE, in, is, I, he, it, we, be, me, if, die, ice, lie, tie, IEC, IQ, id, pie, ire, vie, ye, CIE, UE, IEA, IED, IEP, IH, OE, IEE, ITE, fie, CE, IP, AE, AIE, Ce, De, E, EE, EIE, FIE, Fe, GIE, Ge, IA, IAE, IBE, IC, ICE, ID, IDE, IEF, IEG, IEM, IES, IF, IGE, IJ, IL, IME, IN, INE, IPE, IR, IRE, IS, IT, IU, IV, IZ, Ide, Ike, Ile, Io, IoE, Ir, Ive, JE, KE, LE, Le, ME, MIE, NE, Ne, PE, PIE, RE, RIE, SE, Se, Te, VE, e, hie, i, i3, i5, i7, i9, ii, ise, ite, iv, ix, ize, le, né, re, ve, IB, IG, IM] (4089) [lt:en:MORFOLOGIK_RULE_EN_GB]">ie</span> one where the variation $\delta S$ with respect to any variation of the path $\delta \vbq(t)$ is zero. This equation can be found by solving the Euler-Lagrange equations,</div><div class="clear"></div>
<div class="linenb">&nbsp;42</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;43</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;44</div><div class="codeline">	<span class="keyword1">\label</span>{eq:euler-lagrange}</div><div class="clear"></div>
<div class="linenb">&nbsp;45</div><div class="codeline">	\frac{\p L}{\p q_i} - \frac{\dd}{\dd t}\frac{\p L}{\p \dot q_i} = 0</div><div class="clear"></div>
<div class="linenb">&nbsp;46</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;47</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;48</div><div class="codeline">for each generalised degree of $q_i$. To each we can also associate a conjugate momentum $p_i$ and generalised force $F_i$,</div><div class="clear"></div>
<div class="linenb">&nbsp;49</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;50</div><div class="codeline"><span class="keyword2">\begin{align}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;51</div><div class="codeline">  p_i = \frac{\p L }{\p \dot q_i} \\</div><div class="clear"></div>
<div class="linenb">&nbsp;52</div><div class="codeline">  F_i = \frac{\p L}{\p q_i}</div><div class="clear"></div>
<div class="linenb">&nbsp;53</div><div class="codeline"><span class="keyword2">\end{align}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;54</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;55</div><div class="codeline">such that Equation \eqref{eq:euler-lagrange} reads in line with Newton's second law, $F = \dot{p}_i$.</div><div class="clear"></div>
<div class="linenb">&nbsp;56</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;57</div><div class="codeline">The focus on symmetries within the formalism comes to the fore however when we consider <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [Nether, Norther, No ether] (4508) [lt:en:MORFOLOGIK_RULE_EN_GB]">Noether</span>'s Theorem \cite{noetherInvariantVariationProblems1971} which states that every continuous symmetry of the action $S$ has a corresponding conserved quantity. A simple example of this can be seen for degrees of freedom which are said to be <span class="keyword1">\emph</span>{cyclic} in that the coordinate value itself, $q_i$, does not appear directly in the Lagrangian. It can be readily seen from Equation \eqref{eq:euler-lagrange} that if this is the case then,</div><div class="clear"></div>
<div class="linenb">&nbsp;58</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;59</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;60</div><div class="codeline">  \frac{\dd}{\dd t}\frac{\p L}{\p \dot q_i} = 0</div><div class="clear"></div>
<div class="linenb">&nbsp;61</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;62</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;63</div><div class="codeline">which implies that the conjugate momentum $p_i$ is a conserved quantity of the system.</div><div class="clear"></div>
<div class="linenb">&nbsp;64</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;65</div><div class="codeline"><span class="keyword1">\subsection</span>{Non-Conservative Actions}</div><div class="clear"></div>
<div class="linenb">&nbsp;66</div><div class="codeline"><span class="keyword1">\label</span>{sec:intro-nc-actions}</div><div class="clear"></div>
<div class="linenb">&nbsp;67</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;68</div><div class="codeline"><span class="highlight" title="The genitive ('s) may be missing.. Suggestions: [Lagrangian's mechanics] (4985) [lt:en:MISSING_GENITIVE]">Lagrangian mechanics</span> as discussed applies only to conservative systems. While there exist other extensions to non-conservative systems, notably Rayleigh dissipation functions \cite{struttGeneralTheoremsRelating1871} for simple dissipative functions, we will focus on the method put forward by Galley \<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [tall, stall, Etwall, et all] (5249) [lt:en:MORFOLOGIK_RULE_EN_GB]">etall</span> \cite{galleyClassicalMechanicsNonconservative2013}.</div><div class="clear"></div>
<div class="linenb">&nbsp;69</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;70</div><div class="codeline"><span class="keyword2">\begin{figure}</span>[t]</div><div class="clear"></div>
<div class="linenb">&nbsp;71</div><div class="codeline">  <span class="keyword1">\includegraphics</span>[width=\columnwidth]{figures/qif-two-paths.pdf}</div><div class="clear"></div>
<div class="linenb">&nbsp;72</div><div class="codeline">  <span class="keyword1">\caption</span>{A cartoon based on a similar figure <span class="highlight-sh" title="Do not use 'from [X]': the syntax of a sentence should not be changed by the removal of a citation. [sh:c:noin]">from \cite{</span>galleyClassicalMechanicsNonconservative2013} showing the two virtual paths. We can see that the two paths initiate at their respective initial configurations $\vbq_{i,\set{1,2}}$ at time $t_i$ and are connected by the final configuration $\vbq_f$ at $t_f$. This final configuration is unknown and is allowed to vary within the problem (depicted as two alternative values shown in pale either side), depending on the value of $\vbq_{i,\set{1,2}}$. which are fixed during extremisation (displayed in grey). In this manner, the problem's boundary resides purely in the $t = t_i$ plane where physical information is known. As shown the physical limit (P.L.) consists of bringing the two virtual paths together such as $\vbq_{i, 1} = \vbq_{i, 2}$.}</div><div class="clear"></div>
<div class="linenb">&nbsp;73</div><div class="codeline">  <span class="keyword1">\label</span>{<span class="highlight-sh" title="Figure fig:nc-lagrange-virtual-paths is never referenced in the text [sh:figref]">f</span>ig:nc-lagrange-virtual-paths}</div><div class="clear"></div>
<div class="linenb">&nbsp;74</div><div class="codeline"><span class="keyword2">\end{figure}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;75</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;76</div><div class="codeline">This method was originally developed to account for the fact that while we often employ Hamilton’s principle and the Euler-Lagrange equations it produces as an initial value problem, it is formally a boundary value problem in time. To remedy this difficulty we formally double the degrees of freedom of our system into two new virtual paths $\vb q_{1,2}$, with an adapted non-conservative Lagrangian $\Lambda$ given by,</div><div class="clear"></div>
<div class="linenb">&nbsp;77</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;78</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;79</div><div class="codeline">  <span class="keyword1">\label</span>{eq:nc-lag}</div><div class="clear"></div>
<div class="linenb">&nbsp;80</div><div class="codeline">  \Lambda = L(\vbq_1, \dot\vbq_1, t) - L(\vbq_1, \dot\vbq_1, t) + K(\vbq_1, \vbq_2, \dot\vbq_1, \dot\vbq_2, t).</div><div class="clear"></div>
<div class="linenb">&nbsp;81</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;82</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;83</div><div class="codeline">The form of this equation, as well as the visualisation shown in \fref{fig:<span class="highlight-spelling" title="Possible spelling mistake found. (5733) [lt:en:MORFOLOGIK_RULE_EN_GB]">nc-lagrange-virtual-paths}</span>, shows we can consider this doubling as creating two paths, one forwards in time, the other backwards (and hence negative in \eqref{eq:nc-lag}), with both of these paths contribute with terms as the traditional conservative Lagrangian. There is also an additional term $K$, the non-conservative potential, representing a non-conservative coupling between the two paths (if it could be broken down cleanly into a form of $V(\vbq_1) - V(\vbq_2)$ or similar, and thus being conservative, then these could be absorbed into $L$ leaving $K = 0$). In this way, the system becomes a boundary value <span class="highlight" title="This word has been used in one of the immediately preceding sentences. Using a synonym could make your text more interesting to read, unless the repetition is intentional.. Suggestions: [issue, concern, difficulty] (6301) [lt:en:EN_REPEATEDWORDS]">problem</span> as needed, with both paths sharing the $\vbq_f$ point as one of their boundaries.</div><div class="clear"></div>
<div class="linenb">&nbsp;84</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;85</div><div class="codeline">To solve this system we follow in the same form as before, aiming to <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [extremist, extremism, extremis, ext remise] (6454) [lt:en:MORFOLOGIK_RULE_EN_GB]">extremise</span> a new action defined now in terms of $\Lambda$, however crucially we do so in what is known as the \ensquote{physical limit}<span class="highlight-sh" title="There should be a space after a period. If you are writing a URL or a filename, use the \url{} or \verb markup. [sh:d:002]"> (P.<span class="highlight" title="Add a space between sentences.. Suggestions: [ L] (6573) [lt:en:SENTENCE_WHITESPACE]">L</span>)</span>, where $\vbq_1 = \vbq_2$. This gives the non-conservative Euler Lagrange equation,</div><div class="clear"></div>
<div class="linenb">&nbsp;86</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;87</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;88</div><div class="codeline">	<span class="keyword1">\label</span>{eq:nc-el}</div><div class="clear"></div>
<div class="linenb">&nbsp;89</div><div class="codeline">  	\left[\frac{\p \Lambda}{\p q_i} - \frac{\dd}{\dd t}\frac{\p \Lambda}{\p \dot q_i}\right]_{\text{P.L}} = 0</div><div class="clear"></div>
<div class="linenb">&nbsp;90</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;91</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;92</div><div class="codeline">In practical considerations, it is often useful to alter our choice of variables to instead be $\vbq_+ = {(\vbq_1 + \vbq_2)}/{2}$ and $\vbq_- = \vbq_1 - \vbq_2$. This reduced our P.L. condition to simply $\vbq_- \to \vb 0$. Note that only the Euler-Lagrange equation involving differentiating with respect to $\vbq_-$ survives. We can of course also define <span class="highlight" title="The plural noun 'momenta' cannot be used with the article 'a'. Did you mean 'a corresponding conjugate momentum' or 'corresponding conjugate momenta'?. Suggestions: [a corresponding conjugate momentum, corresponding conjugate momenta] (6920) [lt:en:A_NNS]">a corresponding conjugate momenta</span>,</div><div class="clear"></div>
<div class="linenb">&nbsp;93</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;94</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;95</div><div class="codeline">  \pi_{\mp, i} = \frac{\p \Lambda}{\p q_{\pm,i}}.</div><div class="clear"></div>
<div class="linenb">&nbsp;96</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">&nbsp;97</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;98</div><div class="codeline">A corresponding form of <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [Nether, Norther, No ether] (6981) [lt:en:MORFOLOGIK_RULE_EN_GB]">Noether</span>'s theorem can be shown to hold for these non-conservative systems where the <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [Nether, Norther, No ether] (7065) [lt:en:MORFOLOGIK_RULE_EN_GB]">Noether</span> currents evolve in time due to the effect of the non-conservative coupling potential $K$ \cite{galleyPrincipleStationaryNonconservative2014}. There one can also find a more complete explanation of the process described above, along with a rigorous derivation.</div><div class="clear"></div>
<div class="linenb">&nbsp;99</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">100</div><div class="codeline"><span class="keyword1">\subsection</span>{The \SI}</div><div class="clear"></div>
<div class="linenb">101</div><div class="codeline"><span class="keyword1">\label</span>{sec:intro-si}</div><div class="clear"></div>
<div class="linenb">102</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">103</div><div class="codeline"><span class="highlight" title="Please check whether a word is missing between 'The' and 'is' or whether 'The' is the correct determiner. (7294) [lt:en:MISSING_NOUN]">The</span> \SI{} is an extension of a symplectic integrator to non-conservative Lagrangian mechanics, symplectic integrators being those which preserve the canonical symplectic 2-form of the system $dp \wedge dq$, and thus preserve many desired properties during integration.</div><div class="clear"></div>
<div class="linenb">104</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">105</div><div class="codeline">Hence, to understand the \SI{} method we first consider the application of a symplectic integrator to a traditional conservative system\footnote{This explanation takes its path from an unpublished paper by Tsang \etall \cite{tsangVariationalSymplecticIntegrators}}. As before consider a system with $N$ degrees of freedom represented by some $\vbq \in \R^N$, governed by some Lagrangian, $L(\vbq, \dot{\vbq}, t) \in \R$.</div><div class="clear"></div>
<div class="linenb">106</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">107</div><div class="codeline">With this set up we now choose to apply two successive procedures to our extremal path $\vb q(t)$: first piecewise breakdown and then discretisation of the action itself. It is this ordering that differentiates this symplectic method from more traditional integrators such as <span class="highlight-spelling" title="Possible spelling mistake found. (8055) [lt:en:MORFOLOGIK_RULE_EN_GB]">Runge-Kutta</span> \cite{devriesFirstCourseComputational2011} which solve similar systems by discretising the final equations of motion themselves rather than the action, before equations of motion are formed.</div><div class="clear"></div>
<div class="linenb">108</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">109</div><div class="codeline">To start we break the trajectory down piecewise into a collection of $M$ sub-paths $\gamma_{n \in [M - 1]}$ where $[A] = \set{0, \dots, A}$, each defined on some portion of the whole timespan $[t_n, t_{n + 1}] \subset [t_i, t_f] \subset \R$ such that they cover it completely with overlaps only at the boundaries of the intervals. These together are such that the there is the correspondence,</div><div class="clear"></div>
<div class="linenb">110</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">111</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">112</div><div class="codeline"><span class="keyword1">\label</span>{eq:pw-traj}</div><div class="clear"></div>
<div class="linenb">113</div><div class="codeline">	\vb q(t) = <span class="keyword2">\begin{cases}</span></div><div class="clear"></div>
<div class="linenb">114</div><div class="codeline">		\gamma_n(t) &amp;\text{for~} t \in [t_n, t_{n + 1}]</div><div class="clear"></div>
<div class="linenb">115</div><div class="codeline">	<span class="keyword2">\end{cases}</span></div><div class="clear"></div>
<div class="linenb">116</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">117</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">118</div><div class="codeline">between the total path and sub-paths for all $t \in [t_i, t_f]$. These paths define a collection of points $\vb q_{n \in [M]}$ which are their mutual values at the piecewise breakpoints (which we required to be equal) and the initial and final values for $n = 0$ and $n = M$ respectively.</div><div class="clear"></div>
<div class="linenb">119</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">120</div><div class="codeline">As each piecewise curve constitutes in and of itself a physically attained trajectory we can state that any path $\vb{q}(t)$ which <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [extremists, extremisms, ext remises] (8883) [lt:en:MORFOLOGIK_RULE_EN_GB]">extremises</span> the action for the <span class="highlight" title="This word has been used in one of the immediately preceding sentences. Using a synonym could make your text more interesting to read, unless the repetition is intentional.. Suggestions: [entire, full, complete] (8913) [lt:en:EN_REPEATEDWORDS]">whole</span> timespan, must also <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [extremist, extremism, extremis, ext remise] (8939) [lt:en:MORFOLOGIK_RULE_EN_GB]">extremise</span> each piecewise portion, and visa-versa. </div><div class="clear"></div>
<div class="linenb">121</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">122</div><div class="codeline">This does not bring us closer to a numerical solution directly but allows us to freely split our integral domain as needed without loss of accuracy, and thus limit the error of our numerical-integration method which will necessarily increase with the number of time-steps or their size.</div><div class="clear"></div>
<div class="linenb">123</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">124</div><div class="codeline">We now turn to the discretisation method itself. This is done using the <span class="highlight-spelling" title="Possible spelling mistake found. (9351) [lt:en:MORFOLOGIK_RULE_EN_GB]">Galerkin-Gauss-Lobatto</span> (GGL) quadrature method of order $r \in \N_0$\cite{tsangSLIMPLECTICINTEGRATORSVARIATIONAL2015, farrVariationalIntegratorsGravitational2007} which approximates the integral from $t_n$ to $t_{n + 1}$ using the intermediary points</div><div class="clear"></div>
<div class="linenb">125</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">126</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">127</div><div class="codeline">  t^{(i)}_n = t_n + (1 + x_i)\frac{\Delta t}{2}</div><div class="clear"></div>
<div class="linenb">128</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">129</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">130</div><div class="codeline"><span class="comment"><span class="comment">% NOTE: Orders defined here</span></span></div><div class="clear"></div>
<div class="linenb">131</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">132</div><div class="codeline"><span class="highlight" title="This sentence does not start with an uppercase letter.. Suggestions: [Where] (9489) [lt:en:UPPERCASE_SENTENCE_START]">where</span> $i \in [r + 1]$ and $x_i$ are the ordered roots of <span class="highlight" title="Possible typo: you repeated a word. Suggestions: [the] (9528) [lt:en:ENGLISH_WORD_REPEAT_RULE]">the the</span> derivative of the <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [PTH, CTH, Nth, 0th, 1th, 2th, 3th, 4th, 5th, 6th, 7th, 8th, 9th, ATH, BTH, TH, Th, WTH, XTC, XTP, Ath, ETH] (9554) [lt:en:MORFOLOGIK_RULE_EN_GB]">$(r + 1)$th</span> Legendre polynomial $P_{r + 1}$ and $\Delta t = t_f - t_i$. For a given choice of $r$, this provides <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [symplectic] (9626) [lt:en:MORFOLOGIK_RULE_EN_GB]">slimplectic</span> maps that are accurate up an order $2r + 2$\cite{tsangSLIMPLECTICINTEGRATORSVARIATIONAL2015}. In <span class="highlight" title="A comma is probably missing here.. Suggestions: [turn,] (9682) [lt:en:MISSING_COMMA_AFTER_INTRODUCTORY_PHRASE]">turn</span> we also define $\vbq_n^{(i)} = \vbq(t^{(i)}_n)$ to be the value of each sub-path at each $t^{(i)}_n$, which we label interior points. This process can be seen visually in \fref{fig:<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [subprocess, bioprocess] (9821) [lt:en:MORFOLOGIK_RULE_EN_GB]">si-process}</span>.</div><div class="clear"></div>
<div class="linenb">133</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">134</div><div class="codeline"><span class="keyword2">\begin{figure}</span>[t]</div><div class="clear"></div>
<div class="linenb">135</div><div class="codeline">  <span class="keyword1">\includegraphics</span>[width=\columnwidth]{figures/si-process.pdf}</div><div class="clear"></div>
<div class="linenb">136</div><div class="codeline">  <span class="keyword1">\caption</span>{A depiction of the piecewise breakdown and then discretisation of the action. Each $t_n$ represents shows the action over a subpath $\gamma_n$. In addition we focus on the sub-path spanning $[t_3, t_4]$ showing the interior times $t_{3}^{(i)}$ for $r = 4$.}</div><div class="clear"></div>
<div class="linenb">137</div><div class="codeline">  <span class="keyword1">\label</span>{<span class="highlight-sh" title="Figure fig:si-process is never referenced in the text [sh:figref]">f</span>ig:si-process}</div><div class="clear"></div>
<div class="linenb">138</div><div class="codeline"><span class="keyword2">\end{figure}</span></div><div class="clear"></div>
<div class="linenb">139</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">140</div><div class="codeline">We now approximate the path of the system within this quadrature using the associated cardinal functions for the GGL quadrature, labelled $\phi(t)$, as \(\vb q(t) = \phi(t) + \Or((\Delta t)^{r + 2})\). These provide a suitable approximation for the path derivative $\dot{\vb q}$ by the use of the derivative matrix,</div><div class="clear"></div>
<div class="linenb">141</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">142</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">143</div><div class="codeline"><span class="keyword1">\label</span>{eq:dij}</div><div class="clear"></div>
<div class="linenb">144</div><div class="codeline">  D_{ij} = <span class="keyword2">\begin{cases}</span></div><div class="clear"></div>
<div class="linenb">145</div><div class="codeline">  	\dfrac{(r + 1)(r + 2)}{2\Delta t} &amp;i = j = 0 \\\\</div><div class="clear"></div>
<div class="linenb">146</div><div class="codeline">  	-\dfrac{(r + 1)(r + 2)}{2\Delta t} &amp; i = j = r + 1 \\\\</div><div class="clear"></div>
<div class="linenb">147</div><div class="codeline">  	0 &amp; i = j \land i \notin \set{0, r + 1} \\\\</div><div class="clear"></div>
<div class="linenb">148</div><div class="codeline">  	\dfrac{2P_{r + 1}(x_i)}{P_{r+1}(x_j)(x - x_j)\Delta t} &amp; i\neq j</div><div class="clear"></div>
<div class="linenb">149</div><div class="codeline">  <span class="keyword2">\end{cases}</span></div><div class="clear"></div>
<div class="linenb">150</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">151</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">152</div><div class="codeline">which provides that,</div><div class="clear"></div>
<div class="linenb">153</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">154</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">155</div><div class="codeline">  \dot\phi(t_n^{(i)}) = \sum_{j = 0}^{r + 1} D_{ij}q_n^{(j)}.</div><div class="clear"></div>
<div class="linenb">156</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">157</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">158</div><div class="codeline">In turn, this allows us to express the integral as,</div><div class="clear"></div>
<div class="linenb">159</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">160</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">161</div><div class="codeline"><span class="keyword1">\label</span>{eq:discr-action-1}</div><div class="clear"></div>
<div class="linenb">162</div><div class="codeline">  \int_{t_n}^{t_{n + 1}} L(\vb q, \dot{\vb q}, t) \dd t \approx \sum_{i = 0}^{r + 1} w_i L(q_{n}^{(i)}, \dot\phi_{n}^{(i)}, t_{n}^{(i)})</div><div class="clear"></div>
<div class="linenb">163</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">164</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">165</div><div class="codeline">where the label the approximate expression $L_d^n$ and where $w_i$ are the quadrature weights given by</div><div class="clear"></div>
<div class="linenb">166</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">167</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">168</div><div class="codeline">  w_i = \frac{\Delta t}{(r + 1)(r + 2)(P_{r + 1}(x_i))^2}.</div><div class="clear"></div>
<div class="linenb">169</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">170</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">171</div><div class="codeline">Equation \eqref{eq:discr-action-1} strung together across the different piecewise sub-trajectories defined in equation \eqref{eq:pw-traj} gives us the total discretised action of the system, shown in Equation \eqref{eq:discr-action-2}, that sets symplectic integrators apart from their more general counterparts,</div><div class="clear"></div>
<div class="linenb">172</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">173</div><div class="codeline"><span class="keyword2">\begin{align}</span></div><div class="clear"></div>
<div class="linenb">174</div><div class="codeline"><span class="keyword1">\label</span>{eq:ldn}</div><div class="clear"></div>
<div class="linenb">175</div><div class="codeline">L_d^n &amp;= \sum_{i = 0}^{r + 1} w_i L(q_{n}^{(i)}, \dot\phi_{n}^{(i)}, t_{n}^{(i)}), \\</div><div class="clear"></div>
<div class="linenb">176</div><div class="codeline"><span class="keyword1">\label</span>{eq:discr-action-2}</div><div class="clear"></div>
<div class="linenb">177</div><div class="codeline">  S_d &amp;= \sum_{n = 0}^{M} L_d^n.</div><div class="clear"></div>
<div class="linenb">178</div><div class="codeline"><span class="keyword2">\end{align}</span></div><div class="clear"></div>
<div class="linenb">179</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">180</div><div class="codeline">From here we then <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [extremist, extremism, extremis, ext remise] (10526) [lt:en:MORFOLOGIK_RULE_EN_GB]">extremise</span> this discretised action with respect to the mutual and interior points to obtain the equations of motion of the system as,</div><div class="clear"></div>
<div class="linenb">181</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">182</div><div class="codeline"><span class="keyword2">\begin{gather}</span></div><div class="clear"></div>
<div class="linenb">183</div><div class="codeline">	\frac{\p L_d^{n-1}}{\p q_n} + \frac{\p L_<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [Dan, den, din, DPN, DCN, DFN, DIN, DN, DON, DSN, Din, Don, dan, don, dun] (10692) [lt:en:MORFOLOGIK_RULE_EN_GB]">d^{n}}{</span>\p q_n} = 0 <span class="highlight-sh" title="You should not break lines manually in a paragraph. Either start a new paragraph or stay in the current one. [sh:nobreak]">\</span>\</div><div class="clear"></div>
<div class="linenb">184</div><div class="codeline">	<span class="keyword1">\label</span>{eq:Ld-interior-eom} \frac{\p L_<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [Dan, den, din, DPN, DCN, DFN, DIN, DN, DON, DSN, Din, Don, dan, don, dun] (10714) [lt:en:MORFOLOGIK_RULE_EN_GB]">d^{n}}{</span>\p <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [QC, qr, Q1, Q2, Q3, Q4, QA, QF, QG, QI, Qa, q, qi, qt, QB, QS] (10720) [lt:en:MORFOLOGIK_RULE_EN_GB]">q^{</span>(i)}_n} = 0.</div><div class="clear"></div>
<div class="linenb">185</div><div class="codeline"><span class="keyword2">\end{<span class="highlight" title="This sentence does not start with an uppercase letter.. Suggestions: [Gather] (10733) [lt:en:UPPERCASE_SENTENCE_START]"></span>gather}</span></div><div class="clear"></div>
<div class="linenb">186</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">187</div><div class="codeline">This first equation can be simplified further into two equivalent definitions for the discrete momentum \(\pi_n\),</div><div class="clear"></div>
<div class="linenb">188</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">189</div><div class="codeline"><span class="keyword2">\begin{align}</span></div><div class="clear"></div>
<div class="linenb">190</div><div class="codeline">	<span class="keyword1">\label</span>{eq:pi-n} \pi_n &amp;= -\frac{\p L_d^{n}}{\p q_n} \\</div><div class="clear"></div>
<div class="linenb">191</div><div class="codeline">	<span class="keyword1">\label</span>{eq:pi-n+1} \pi_{n + 1} &amp;= \frac{\p L_d^{n}}{\p q_{n + 1}}</div><div class="clear"></div>
<div class="linenb">192</div><div class="codeline"><span class="keyword2">\end{align}</span></div><div class="clear"></div>
<div class="linenb">193</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">194</div><div class="codeline">and a continuity constraint that they both be equal at these mutual overlap points $\vbq_n$ in the same manner as we required for $\vbq_n$ itself. Together Equations \eqref{eq:Ld-interior-eom}, \eqref{eq:pi-n} can be solved to determine the values of $\vb q^{(i)}_n$, from which Equation \eqref{eq:pi-n+1} provides a form for determining $\pi_{n + 1}$.</div><div class="clear"></div>
<div class="linenb">195</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">196</div><div class="codeline">This derivation is provided in terms of the traditional conservative Lagrangian $L$ however can be readily adapted to the non-conservative Lagrangian formalism discussed in \sref{sec:<span class="highlight-spelling" title="Possible spelling mistake found. (11284) [lt:en:MORFOLOGIK_RULE_EN_GB]">intro-nc-actions}</span> by considering instead the non-conservative Euler-Lagrange Equation \eqref{eq:nc-el}, in effect substituting $L$ for the non-conservative Lagrangian $\Lambda$ and $\vb q_n$ for $\vb q_{n, -}$.</div><div class="clear"></div>
<div class="linenb">197</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">198</div><div class="codeline">Continuing the consideration of <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [Nether, Norther, No ether] (11481) [lt:en:MORFOLOGIK_RULE_EN_GB]">Noether</span> currents from prior sections, it can be shown that the continuous symmetries of the conservative action evolve as due to this now discretised $K_d$. It should be noted that GGL discretisation does not preserve time-shift symmetry, and hence energy is not conserved under the operation, however, we will show, in line with previous work \cite{tsangSLIMPLECTICINTEGRATORSVARIATIONAL2015}, that the fractional error is generally bounded over the integration.</div><div class="clear"></div>
<div class="linenb">199</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">200</div><div class="codeline"><span class="keyword1">\subsection</span>{Physics Informed Neural Networks}</div><div class="clear"></div>
<div class="linenb">201</div><div class="codeline"><span class="keyword1">\label</span>{sec:intro-pinn}</div><div class="clear"></div>
<div class="linenb">202</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">203</div><div class="codeline">Physics-informed neural networks (PINNs) are neural networks which include physical knowledge in their training processes \cite{raissiPhysicsInformedDeep2017}.</div><div class="clear"></div>
<div class="linenb">204</div><div class="codeline">Their most common application is in solving partial differential equations (<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [Pies, PDAs, PDS, Odes, PDFs, Ides, Pde, 3DES, DES, Des, FDES, IDES, NDEs, PAES, PES, Pyes, Pees, PD Es, IDEs, PDMS, PPEs] (12134) [lt:en:MORFOLOGIK_RULE_EN_GB]">PDEs</span>) \cite{luDeepXDEDeepLearning2021,mengCompositeNeuralNetwork2020} where we take physically derived knowledge of the system as a prior when constructing our ML model. For example, one could train the neural network with a loss function incorporating the residuals from the initial and boundary conditions to (loss functions will be discussed in more depth in \sref{sec:<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [intro, intros, introit, introits, intron, intronic, introns, introrse] (12440) [lt:en:MORFOLOGIK_RULE_EN_GB]">intro-lf}</span>).</div><div class="clear"></div>
<div class="linenb">205</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">206</div><div class="codeline">Neural networks more <span class="highlight" title="This word has been used in one of the immediately preceding sentences. Using a synonym could make your text more interesting to read, unless the repetition is intentional.. Suggestions: [mostly, mainly, largely, typically] (12473) [lt:en:EN_REPEATEDWORDS]">generally</span> are a collection of linear and non-linear components composed together to form complex non-linear functions. At their base level the linear components can be expressed as the simple linear equation \(\vb{y} = W\vb{x} + \vb{b}\) where $\vb x$ is the input for this component, $W$ is a matrix of weights and $\vb{b}$ an offset with components known as biases. The non-linear components are functions such as sigmoid or $\tanh$, which introduce non-linearity into the model, allowing for non-trivial behaviour. Without these non-linear components, the whole model could be expressed as a single linear operation. Collectively, these weights, biases, and other variables within the model constitute the model's <span class="keyword1">\emph</span>{parameters}.</div><div class="clear"></div>
<div class="linenb">207</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">208</div><div class="codeline">This composition is useful as it can be shown that, with sufficient complexity, these forms are dense in the space of Borel measurable functions and hence can take the place of almost any physical function or mathematical procedure \cite{hornikMultilayerFeedforwardNetworks1989}.</div><div class="clear"></div>
<div class="linenb">209</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">210</div><div class="codeline"><span class="keyword1">\subsection</span>{Loss functions}</div><div class="clear"></div>
<div class="linenb">211</div><div class="codeline"><span class="keyword1">\label</span>{sec:intro-lf}</div><div class="clear"></div>
<div class="linenb">212</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">213</div><div class="codeline">The primary method of training ML models involves the construction of a loss function or equivalently a reward function, this frames the training process as a high-dimensionality optimisation problem. In this setting, the parameters of the model are varied <span class="highlight" title="'So as to' expresses purpose and is used in formal texts. Consider using 'to'. Suggestions: [to] (13666) [lt:en:SO_AS_TO]">so as to</span> minimise the aggregate loss of the model's action over a large collection of inputs when compared to known corresponding outputs. It is thus the loss function that grounds the model in a given <span class="highlight" title="This word has been used in one of the immediately preceding sentences. Using a synonym could make your text more interesting to read, unless the repetition is intentional.. Suggestions: [issue, concern, difficulty] (13868) [lt:en:EN_REPEATEDWORDS]">problem</span>, in PINNs, where physics steps in to connect our computational model to reality. Their construction varies<span class="highlight" title="Use a comma before 'but' if it connects two independent clauses (unless they are closely connected and short).. Suggestions: [, but] (13982) [lt:en:COMMA_COMPOUND_SENTENCE]"> but</span> they exhibit some general characteristics as will be discussed.</div><div class="clear"></div>
<div class="linenb">214</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">215</div><div class="codeline">A loss function traditionally takes the form, $\mathrm{loss} = f(y_{\text{true}}, y_{\text{pred}})$ where $f$ is some chosen function and $y_{\text{pred}}$ and $y_{\text{true}}$ are both real vectors in the output space of the model, representing the model's output and the known true output respectively.</div><div class="clear"></div>
<div class="linenb">216</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">217</div><div class="codeline">Loss functions in PINNs are often comprised of two components. First, there is the prediction or physical loss which may, as mentioned, be made up of the residuals of the model under PDE, boundary, and initial conditions of the system. Second, there is a regularisation loss term which helps to penalise overfitting to the training data, expressed as \ensquote{complexity}, within the model. This might be implemented as an $L^2$ of a vector containing all parameters of the model.</div><div class="clear"></div>
<div class="linenb">218</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">219</div><div class="codeline">Stochastic gradient descent and Adam \cite{kingmaAdamMethodStochastic2017} are both common choices for the optimisation algorithm used in loss-function based training. These impose various requirements on the loss function, for example, that it is differentiable<span class="highlight" title="Don't put a space before the full stop.. Suggestions: [.] (14969) [lt:en:COMMA_PARENTHESIS_WHITESPACE]"> \footnote{Although methods exist for non-differentiable functions \cite{daubechiesIterativeThresholdingAlgorithm2003}.}</span> <span class="highlight" title="This sentence does not start with an uppercase letter.. Suggestions: [And] (14972) [lt:en:UPPERCASE_SENTENCE_START]">and</span> benefits from other properties such as higher-order differentiability, and convexity \cite{sraOptimizationMachineLearning2012}. The rate at which these methods apply gradient-based updates is determined by a provided learning rate. This will often be varied through training to quickly move towards minima during the initial stages, then tuned down to avoid \ensquote{jumping} over the minima as we close in on the optimal solution.</div><div class="clear"></div>
<div class="linenb">220</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">221</div><div class="codeline"><span class="keyword1">\subsection</span>{Lagrangian Embeddings}</div><div class="clear"></div>
<div class="linenb">222</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">223</div><div class="codeline">To work with non-conservative Lagrangians $\Lambda$ computationally, for example as the output of a PINN, or one of the inputs of a loss function, we must define some mapping from a collection of real numbers, to a form of $\Lambda(\vbq, \dot\vbq, t)$. This can be thought of as a function,</div><div class="clear"></div>
<div class="linenb">224</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">225</div><div class="codeline"><span class="keyword2">\begin{equation}</span></div><div class="clear"></div>
<div class="linenb">226</div><div class="codeline">  E: \R^n \to \mathbb{L}</div><div class="clear"></div>
<div class="linenb">227</div><div class="codeline"><span class="keyword2">\end{equation}</span></div><div class="clear"></div>
<div class="linenb">228</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">229</div><div class="codeline">where $E$ is known as an \ensquote{embedding function} and $\mathbb{L}$ is a subset of the overall function space of possible $\Lambda$ values. </div><div class="clear"></div>
<div class="linenb">230</div><div class="codeline">The choice of embedding necessarily restricts and dictates the physical systems which the model can deal with, and hence our choice of embedding is crucial. Discussions of different embeddings used in this paper can be found in \sref{sec:<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [Eglwys, egises] (15987) [lt:en:MORFOLOGIK_RULE_EN_GB]">eg-sys}</span>.</div><div class="clear"></div>
<div class="linenb">231</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">232</div><div class="codeline">There are two broad approaches to designing an embedding function. Either one can be chosen to represent a specific system by its physical parameters, or a more broad class of systems can be represented by some arbitrary function approximation scheme, such as Fourier series or Taylor expansion around a point.</div><div class="clear"></div>
<div class="linenb">233</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">234</div><div class="codeline">It should be noted that these embeddings often will not have a unique correspondence with physical Lagrangians, <span class="highlight-sh" title="Use a backslash or comma after the second period; otherwise LaTeX will think it is a full stop ending a sentence. [sh:011]">i.e. </span>the map is not injective up to physical behaviour. This has implications for optimisation in creating multiple minima, as will be discussed.</div><div class="clear"></div>
<div class="linenb">235</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">236</div><div class="codeline"><span class="keyword1">\subsection</span>{Automatic-Differentiation, <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [SLA, DLA, BLA, CLA, ELA, FLA, GLA, HLA, JLA, LA, MLA, OLA, PLA, TLA, VLA, XGA, XL, XLG, XNA, XLI, XLV, X LA, XL A, XLS, XIA] (16594) [lt:en:MORFOLOGIK_RULE_EN_GB]">XLA</span>, and Google's <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [TAX, MAX, JAW, WAX, AJAX, FAX, JAR, SAX, LAX, JAL, JAN, JAB, JAG, JAY, VAX, JAM, AAX, AX, BAX, DAX, EAX, JA, JAA, JAC, JAF, JAI, JAK, JAP, JPX, JSX, JAH, JAT, J AX, JA X, PAX] (16612) [lt:en:MORFOLOGIK_RULE_EN_GB]"></span>JAX}</div><div class="clear"></div>
<div class="linenb">237</div><div class="codeline"><span class="keyword1">\label</span>{sec:intro-autodiff}</div><div class="clear"></div>
<div class="linenb">238</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">239</div><div class="codeline">Automatic-differentiation is the process of computing the differential of \ensquote{regular} code with respect to one or more of its arguments. Google's <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [TAX, MAX, JAW, WAX, AJAX, FAX, JAR, SAX, LAX, JAL, JAN, JAB, JAG, JAY, VAX, JAM, AAX, AX, BAX, DAX, EAX, JA, JAA, JAC, JAF, JAI, JAK, JAP, JPX, JSX, JAH, JAT, J AX, JA X, PAX] (16760) [lt:en:MORFOLOGIK_RULE_EN_GB]">JAX</span> library \cite{jax2018github} contains one implementation of this in Python which works by passing \ensquote{tracers} into the Python code that records the actions done to them such that an overall differential can be calculated.</div><div class="clear"></div>
<div class="linenb">240</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">241</div><div class="codeline"><span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [TAX, MAX, JAW, WAX, AJAX, FAX, JAR, SAX, LAX, JAL, JAN, JAB, JAG, JAY, VAX, JAM, AAX, AX, BAX, DAX, EAX, JA, JAA, JAC, JAF, JAI, JAK, JAP, JPX, JSX, JAH, JAT, J AX, JA X, PAX] (16966) [lt:en:MORFOLOGIK_RULE_EN_GB]">JAX</span> also incorporates the <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [SLA, DLA, BLA, CLA, ELA, FLA, GLA, HLA, JLA, LA, MLA, OLA, PLA, TLA, VLA, XGA, XL, XLG, XNA, XLI, XLV, X LA, XL A, XLS, XIA] (16992) [lt:en:MORFOLOGIK_RULE_EN_GB]">XLA</span> (Accelerated Linear Algebra) library \cite{openxla-xla}, where it uses similar tracing methods to translate a restricted, but large, subset of Python code into a series of low-level efficient operations which can be executed at speed on the GPU or CPU.</div><div class="clear"></div>
<div class="linenb">242</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">243</div><div class="codeline">These two technologies together show great promise in the fields of machine learning and physics simulation, as they allow for code that would previously have to be written in low-level languages, such as C or C++, to be expressed in Python which makes high-performance simulations much easier to develop and iterate on.</div><div class="clear"></div>
</div>
<h2 class="filename">3-results-discussion.tex</h2>

<p>Found 12 warning(s)</p>
<div class="original-file">
<div class="linenb">&nbsp;1</div><div class="codeline"><span class="keyword1">\section</span>{Results and Specific Discussion}</div><div class="clear"></div>
<div class="linenb">&nbsp;2</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;3</div><div class="codeline">\input{results-si.tex}</div><div class="clear"></div>
<div class="linenb">&nbsp;4</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;5</div><div class="codeline">\input{results-lf.tex}</div><div class="clear"></div>
<div class="linenb">&nbsp;6</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;7</div><div class="codeline">\input{results-pinn.tex}</div><div class="clear"></div>
<div class="linenb">&nbsp;8</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;9</div><div class="codeline"><span class="keyword1">\section</span>{Discussion}</div><div class="clear"></div>
<div class="linenb">10</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">11</div><div class="codeline">\<span class="highlight-sh" title="Avoid stacked headings, i.e. consecutive headings without text in between. [sh:stacked]">subsection</span>{\SI{}}</div><div class="clear"></div>
<div class="linenb">12</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">13</div><div class="codeline">We have presented a number of results on the performance characteristics of our \updimpl{} of the \SI{} method applied to physical problems. These warrant additional discussion to place them in context and examine their implications for experimental work.</div><div class="clear"></div>
<div class="linenb">14</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">15</div><div class="codeline">Starting with the effect of changing the method order $r$, as presented in \fref{fig:<span class="highlight-spelling" title="Possible spelling mistake found. (372) [lt:en:MORFOLOGIK_RULE_EN_GB]">dho-r-runtime}</span>.</div><div class="clear"></div>
<div class="linenb">16</div><div class="codeline">Roughly constant-time behaviour is observed and is expected to continue for higher values of $r$, as this reflects very little change in the size of the underlying calculation (due to data size and calculation cost) involved in the integration process.</div><div class="clear"></div>
<div class="linenb">17</div><div class="codeline">This, coupled with the ability to split long integration runs (high $\Niter$ values) into multiple successive runs, means, that with careful management of errors (especially <span class="highlight" title="Use 'in regard to', 'with regard to', or more simply 'regarding'.. Suggestions: [in regard to, with regard to, regarding] (805) [lt:en:IN_OR_WITH_REGARDS_TO_OF]">with regards to</span> round-off build-up due to fixed precision floats), we should be able to limit the degradation to the linear performance observed in \fref{fig:<span class="highlight-spelling" title="Possible spelling mistake found. (957) [lt:en:MORFOLOGIK_RULE_EN_GB]">dho-n-runtime}</span> for $\Niter &gt; 10^7$.</div><div class="clear"></div>
<div class="linenb">18</div><div class="codeline">From this $\Niter$ value the method's internal arrays become greater than 1Gb in size possibly hitting <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [TAX, MAX, JAW, WAX, AJAX, FAX, JAR, SAX, LAX, JAL, JAN, JAB, JAG, JAY, VAX, JAM, AAX, AX, BAX, DAX, EAX, JA, JAA, JAC, JAF, JAI, JAK, JAP, JPX, JSX, JAH, JAT, J AX, JA X, PAX] (1074) [lt:en:MORFOLOGIK_RULE_EN_GB]">JAX</span> de-optimisation.</div><div class="clear"></div>
<div class="linenb">19</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">20</div><div class="codeline">It is important to note however, that in the high order domain $r \gtrsim 40$ the computation of the derivative matrix, given in Equation \eqref{eq:dij}, begins to fail as we encounter issues with the \texttt{float64} floating point precision used in <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [TAX, MAX, JAW, WAX, AJAX, FAX, JAR, SAX, LAX, JAL, JAN, JAB, JAG, JAY, VAX, JAM, AAX, AX, BAX, DAX, EAX, JA, JAA, JAC, JAF, JAI, JAK, JAP, JPX, JSX, JAH, JAT, J AX, JA X, PAX] (1312) [lt:en:MORFOLOGIK_RULE_EN_GB]">JAX</span> calculations. Unfortunately, this is unavoidable as it is the maximum precision offered by <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [TAX, MAX, JAW, WAX, AJAX, FAX, JAR, SAX, LAX, JAL, JAN, JAB, JAG, JAY, VAX, JAM, AAX, AX, BAX, DAX, EAX, JA, JAA, JAC, JAF, JAI, JAK, JAP, JPX, JSX, JAH, JAT, J AX, JA X, PAX] (1407) [lt:en:MORFOLOGIK_RULE_EN_GB]">JAX</span>. Nonetheless, this limitation can be mitigated, whilst retaining the desired error characteristics by employing alternative strategies, such as reducing the time step or using a higher-order method with a lower value.</div><div class="clear"></div>
<div class="linenb">21</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">22</div><div class="codeline">Overall, however, this approach is made more fruitful by noting that we can avoid the fixed cost entirely if we reuse the same of form non-conservative Lagrangian.</div><div class="clear"></div>
<div class="linenb">23</div><div class="codeline">This allows us to vary not only initial conditions, for example exploring the same system in different circumstances or restarting after multiple runs, but also sample across a range of physical parameters -- for example those parameterising the DHO 3 embedding as defined in Equation \eqref{eq:dho-sys-embedding}.</div><div class="clear"></div>
<div class="linenb">24</div><div class="codeline">In particular, this scaling without fixed costs applies effectively to systems composed of many repeated sub-systems, such as field theory or molecular dynamics simulations \cite{tuckermanUnderstandingModernMolecular2000b}.</div><div class="clear"></div>
<div class="linenb">25</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">26</div><div class="codeline">As shown in \fref{fig:<span class="highlight-spelling" title="Possible spelling mistake found. (2277) [lt:en:MORFOLOGIK_RULE_EN_GB]">dho-n-runtime}</span>, we observe a transient increase in runtime over the range $r \in [7, 9]$. This phenomenon is repeatable<span class="highlight" title="Use a comma before 'and' if it connects two independent clauses (unless they are closely connected and short).. Suggestions: [, and] (2382) [lt:en:COMMA_COMPOUND_SENTENCE_2]"> and</span> its origin is uncertain. However, informed by the size of the quadrature array being $r + 2$, we suspect that this behaviour is due to optimisation cliffs in the <span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [TAX, MAX, JAW, WAX, AJAX, FAX, JAR, SAX, LAX, JAL, JAN, JAB, JAG, JAY, VAX, JAM, AAX, AX, BAX, DAX, EAX, JA, JAA, JAC, JAF, JAI, JAK, JAP, JPX, JSX, JAH, JAT, J AX, JA X, PAX] (2543) [lt:en:MORFOLOGIK_RULE_EN_GB]">JAX</span> internal code, as we transition between two internal implementations optimised for small vs large array sizes. Finally, it is important to consider that for less trivial systems, where evaluating the Lagrangian may bring its own performance considerations, the method may require further analysis and optimisation.</div><div class="clear"></div>
<div class="linenb">27</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">28</div><div class="codeline">Looking forward, we noted that the use of fixed time steps in the method limits our ability to maintain energy and momentum fractional error bounds. Moving to an adaptive time step approach would be a promising avenue for improvement in future work.</div><div class="clear"></div>
<div class="linenb">29</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">30</div><div class="codeline"><span class="keyword1">\subsection</span>{PINN, Current and Future}</div><div class="clear"></div>
<div class="linenb">31</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">32</div><div class="codeline">The trained neural network represents a promising first step in predicting non-conservative Lagrangians from observational data, successfully capturing the general characteristics of the data.</div><div class="clear"></div>
<div class="linenb">33</div><div class="codeline">During our experiments, we frequently observed predicted embeddings with values of roughly correct proportion, but off by a constant factor.</div><div class="clear"></div>
<div class="linenb">34</div><div class="codeline">This suggests that the 4 parameter embedding, or other normalisation methods, may have been useful as the model was unable to move past this local minima in phase space, representing a sufficiently similar physical system.</div><div class="clear"></div>
<div class="linenb">35</div><div class="codeline">This poses questions on the handling of degeneracy in our Lagrangian space, where multiple Lagrangians can result in the same physical system, especially within the image of any chosen embedding function, as this degeneracy will present issues when optimising within the space.</div><div class="clear"></div>
<div class="linenb">36</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">37</div><div class="codeline">Furthermore, we noted that the model was substantially more accurate with comparatively high masses. We theorise that this may be due to difficulties in fitting larger values of $\vbq$, possibly indicating the need for a larger and more varied dataset. It is important to acknowledge that this was a simplified test network, and we anticipate that future work will achieve improvements by utilising a larger parameter count and datasets.</div><div class="clear"></div>
<div class="linenb">38</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">39</div><div class="codeline">To enhance the model's performance, incorporating physically known a priori information into the loss function may be beneficial. For example, a stricter restriction on non-negativity for the DHO 3 parameters could be implemented by first taking the absolute value of the outputs as inputs to the Slimplectic Integrator. This would have the effect of cleanly solving the problem of non-physical embedding values, at the cost of introducing additional degeneracy into our space possibly confusing the model.</div><div class="clear"></div>
<div class="linenb">40</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">41</div><div class="codeline">It should be noted, however, that this and similar approaches, present a trade-off between specialising our embedding and loss functions towards a particular class of physical systems where we have more physical knowledge, and on the other hand, creating models which are more widely applicable, where we are unable to draw such physically derived conclusions (for example when using Taylor series embedding functions).</div><div class="clear"></div>
<div class="linenb">42</div><div class="codeline">Identifying physical laws that can be enforced in the Lagrangian would be a fruitful avenue for future research.</div><div class="clear"></div>
<div class="linenb">43</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">44</div><div class="codeline">Following this theme, a suitably trained neural network could be constructed using this method to identify symmetries in observational data or recognise patterns it has previously been exposed to in new observational data. This suggests potential applications in domains such as astrophysics, where there is a large availability of data to train a model, but also difficulties in obtaining a complete dataset for any one experiment.</div><div class="clear"></div>
<div class="linenb">45</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">46</div><div class="codeline">\<span class="highlight-sh" title="This section is very short (about 88 words). You should consider merging it with another section or make it longer. [sh:seclen]"><span class="highlight-sh" title="This section is very short (about 88 words). You should consider merging it with another section or make it longer. [sh:seclen]">section</span></span>{Conclusion}</div><div class="clear"></div>
<div class="linenb">47</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">48</div><div class="codeline">In this paper, we have put forward a more optimal implementation of the Slimplectic Integrator, which is capable of scaling to large-scale physical simulations while preserving bounded fractional error in the energy. We have shown this implementation has applications in the construction of a loss function for physics-informed neural networks, and presented a simple model which shows that this approach has promise for identifying non-conservative Lagrangians from observational data. More work is required to explore better encodings of physical invariants in the loss function and model structure.</div><div class="clear"></div>
</div>
<h2 class="filename">results-lf.tex</h2>

<p>Found 3 warning(s)</p>
<div class="original-file">
<div class="linenb">&nbsp;1</div><div class="codeline"><span class="keyword1">\subsection</span>{Loss Functions and Optimisation}</div><div class="clear"></div>
<div class="linenb">&nbsp;2</div><div class="codeline"><span class="keyword1">\label</span>{sec:res-lf}</div><div class="clear"></div>
<div class="linenb">&nbsp;3</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;4</div><div class="codeline">Moving now onto the loss function and choice of Lagrangian embedding function. We explored several loss functions through a combination of gradient descent and visual inspection.</div><div class="clear"></div>
<div class="linenb">&nbsp;5</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">&nbsp;6</div><div class="codeline">A wide number of loss functions were tested, however focusing on those surrounding systems of harmonic oscillators, we settled on damped harmonic oscillator (DHO) system-specific embedding shown in equation \eqref{eq:dho-sys-embedding}, labelled DHO 3.</div><div class="clear"></div>
<div class="linenb">&nbsp;7</div><div class="codeline">As well as an adaption where an additional embedding parameter $\alpha$ was introduced as a pre-factor on the entire non-conservative Lagrangian $\Lambda$, labelled DHO 4. </div><div class="clear"></div>
<div class="linenb">&nbsp;8</div><div class="codeline">These were paired with a number of simple loss functions, \tref{table:<span class="highlight-spelling" title="Possible spelling mistake found.. Suggestions: [losses, lessons, lossless, lessens, loosens, gossoons, toss-ups, lossages] (662) [lt:en:MORFOLOGIK_RULE_EN_GB]">loss-fns}</span>, drawing from physical knowledge and existing conventions for neural network loss functions.</div><div class="clear"></div>
<div class="linenb">&nbsp;9</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">10</div><div class="codeline">First, we perform a visual inspection of the \ensquote{Simple RMS} loss function at various scales with both embedding functions, as seen in \fref{fig:loss-function-behaviour}. Here we observe mild non-convexity around the minima, as impulse like behaviour around the highly non-physical $m = 0$ point.</div><div class="clear"></div>
<div class="linenb">11</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">12</div><div class="codeline">To test how this mild non-convexity translates into optimisation performance we subject a number of combinations to empirical optimisation tests where we attempt to attain a known true embedding from a number of random initial embedding values. \Tref{<span class="highlight" title="This sentence does not start with an uppercase letter.. Suggestions: [Table] (1290) [lt:en:UPPERCASE_SENTENCE_START]">table</span>:optimisation-results} (see caption for details) shows that the addition of the global pre-factor $\alpha$ substantially increases the probability of successful convergence.  In addition, we see that both the $\vbq$ and $\pi$ values are important in the fitting process from the complete lack of convergence when only $\pi$ is included and that their relative weight seems to be of little importance at this stage.</div><div class="clear"></div>
<div class="linenb">13</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">14</div><div class="codeline">This is promising as, while optimisation directly in the embedding space is a strictly simpler problem than with respect to the parameters of an associated neural network, it suggests that this mild non-convexity observed during visual inspection is an obstacle we can overcome.</div><div class="clear"></div>
<div class="linenb">15</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">16</div><div class="codeline"><span class="keyword2">\begin{figure*}</span>[t]</div><div class="clear"></div>
<div class="linenb">17</div><div class="codeline">  <span class="keyword1">\includegraphics</span>[width=\textwidth]{figures/loss-function-behaviour.pdf}</div><div class="clear"></div>
<div class="linenb">18</div><div class="codeline">  <span class="keyword1">\caption</span>{The local behaviour of an equally weighted $\vbq$ and $\pi$ RMS loss function, when viewed as a function of variation in each of the embedding variables independently, with others kept fixed. We observe roughly correct behaviour in all variables bar mass $m$ and subsequently $\alpha$ for the DHO 4 embedding where $\alpha$ acts as a pre-factor for the whole non-conservative Lagrangian $\Lambda$. This behaviour is to be expected as a system without mass is non-physical and explodes to infinity.}</div><div class="clear"></div>
<div class="linenb">19</div><div class="codeline">  <span class="keyword1">\label</span>{<span class="highlight-sh" title="Figure fig:loss-function-behaviour is never referenced in the text [sh:figref]">fig:loss-function-behaviour</span>}</div><div class="clear"></div>
<div class="linenb">20</div><div class="codeline"><span class="keyword2">\end{figure*}</span></div><div class="clear"></div>
<div class="linenb">21</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">22</div><div class="codeline"><span class="keyword2">\begin{table}</span></div><div class="clear"></div>
<div class="linenb">23</div><div class="codeline"><span class="keyword1">\label</span>{table:loss-fns}</div><div class="clear"></div>
<div class="linenb">24</div><div class="codeline">\centering</div><div class="clear"></div>
<div class="linenb">25</div><div class="codeline"><span class="keyword1">\caption</span>{Different loss functions used, their names and descriptions of their function. Key: RMS = Root Mean Squared, a standard loss function in machine learning.<span class="comment">%; inv-exp t.w. = inverse exponential time weighting.</span></div><div class="clear"></div>
<div class="linenb">26</div><div class="codeline">}</div><div class="clear"></div>
<div class="linenb">27</div><div class="codeline"><span class="keyword2">\begin{tabular}</span>{c|p{0.5\linewidth}}</div><div class="clear"></div>
<div class="linenb">28</div><div class="codeline">  Name &amp; Description \\</div><div class="clear"></div>
<div class="linenb">29</div><div class="codeline">  \hline</div><div class="clear"></div>
<div class="linenb">30</div><div class="codeline">  Simple RMS &amp; Sum of RMS for $\vbq$ and $\pi$ in equal weighting. \\</div><div class="clear"></div>
<div class="linenb">31</div><div class="codeline">  RMS-$(a, b)$ &amp; Sum of $a$ times the RMS for $\vbq$ and $b$ times the RMS for $\pi$. \\</div><div class="clear"></div>
<div class="linenb">32</div><div class="codeline"><span class="comment"><span class="comment">%  RMS inv-exp t.w. &amp; Weighting the contribution from each time-step by $e^{-t}$  \\</span></span></div><div class="clear"></div>
<div class="linenb">33</div><div class="codeline"><span class="keyword2">\end{tabular}</span></div><div class="clear"></div>
<div class="linenb">34</div><div class="codeline"><span class="keyword2">\end{table}</span></div><div class="clear"></div>
<div class="linenb">35</div><div class="codeline">&nbsp;</div><div class="clear"></div>
<div class="linenb">36</div><div class="codeline"><span class="keyword2">\begin{table}</span></div><div class="clear"></div>
<div class="linenb">37</div><div class="codeline"><span class="keyword1">\label</span>{table:optimisation-results}</div><div class="clear"></div>
<div class="linenb">38</div><div class="codeline">\centering</div><div class="clear"></div>
<div class="linenb">39</div><div class="codeline"><span class="keyword1">\caption</span>{Results of optimising the chosen loss function from \tref{table:loss-fns} for $200$ initially random embeddings (distributed uniformly in $[0, 10]^n$) in the input space of the chosen embedding function, where convergence is defined as being within $\epsilon = 0.05$ of the true embedding at the end of a maximum of $250$ iterations of the optimiser. Note that for DHO 4 an additional normalisation step of dividing by $\alpha$ was applied to remove the redundancy introduced by the pre-factor when determining if convergence had been achieved. The true embedding that was optimised towards, in DHO 3 form, was $(m = 2, k = 3, \lambda = 1)$ and systems were compared with $\Niter = 50, r = 2, \Delta t = 0.1, q_0 = 0, \pi_0 = 1$.}</div><div class="clear"></div>
<div class="linenb">40</div><div class="codeline"><span class="keyword2">\begin{tabular}</span>{l|l|c}</div><div class="clear"></div>
<div class="linenb">41</div><div class="codeline">  Loss function &amp; Embedding &amp; Convergence $\%$ \\</div><div class="clear"></div>
<div class="linenb">42</div><div class="codeline">  \hline</div><div class="clear"></div>
<div class="linenb">43</div><div class="codeline">  Simple RMS &amp; DHO 3 &amp; $33.5\%$ \\</div><div class="clear"></div>
<div class="linenb">44</div><div class="codeline">  Simple RMS &amp; DHO 4 &amp; $97.5\%$ \\</div><div class="clear"></div>
<div class="linenb">45</div><div class="codeline">  RMS-$(2, 1)$ &amp; DHO 4 &amp; $98\%$ \\</div><div class="clear"></div>
<div class="linenb">46</div><div class="codeline">  RMS-$(0, 1)$ &amp; DHO 4 &amp; $0\%$ \\</div><div class="clear"></div>
<div class="linenb">47</div><div class="codeline"><span class="comment"><span class="comment">%  RMS inv-exp t.w. &amp; DHO 3 &amp;</span></span></div><div class="clear"></div>
<div class="linenb">48</div><div class="codeline"><span class="keyword2">\end{tabular}</span></div><div class="clear"></div>
<div class="linenb">49</div><div class="codeline"><span class="keyword2">\end{table}</span></div><div class="clear"></div>
</div>
<hr/>
Output produced by TeXtidote v0.8.2, &copy; 2018-2020 Sylvain Hall&eacute; - All rights reserved.<br/>
See the <a href="https://sylvainhalle.github.io/textidote">TeXtidote website</a> for more information.
</body>
</html>
